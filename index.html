<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Department of Justice Information System</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z">
    <!-- Chosen Palette: Warm Neutrals & Professional Blue -->
    <!-- Application Structure Plan: A comprehensive sidebar navigation-based SPA. The user selects a topic from a persistent left-hand sidebar (e.g., 'Core Rights', 'Case Law Library', 'Specific Legislation'), and the main content area on the right dynamically updates. This structure is designed for rapid information retrieval and layered learning, allowing attorneys to quickly pinpoint specific legal concepts, common defenses, or case law precedents. This non-linear, topic-based navigation, enhanced with internal linking for deeper dives, transforms the original report into a dynamic, interconnected knowledge base, prioritizing user understanding and efficient task completion. -->
    <!-- Visualization & Content Choices:
        - Report Info: Statute of Limitations (15 days for charges/evidence). Goal: Inform/Compare. Viz/Method: Chart.js Bar Chart. Interaction: Hover tooltips. Justification: A visual comparison is effective for understanding time limits. Library: Chart.js.
        - Report Info: Expungement Fees ($1500, $3000, $6000). Goal: Compare. Viz/Method: Chart.js Bar Chart. Interaction: Hover tooltips. Justification: Visually represents the escalating fee structure clearly. Library: Chart.js.
        - Report Info: Case Law (Terry, Miranda, Tekoh, Garner, Mimms, Houghton, Carroll). Goal: Organize/Inform. Viz/Method: Clickable HTML tabs. Interaction: User clicks a case name to reveal its details, principle, and defense application. Justification: Breaks down complex legal precedents into digestible, user-driven chunks. Method: HTML/JS.
        - Report Info: Strategic Defense (Drugs, Murder). Goal: Organize/Inform. Viz/Method: Accordion/collapsible sections. Interaction: User clicks a topic to expand/collapse content. Justification: Keeps the UI clean and focused, allowing targeted access to strategic advice. Method: HTML/JS.
        - Report Info: FOIA Request Process. Goal: Organize/Inform. Viz/Method: Styled HTML divs with arrows representing a flowchart. Interaction: None. Justification: Visually represents a sequence of steps more clearly than a bulleted list. Method: HTML/Tailwind.
        - Report Info: Stand Your Ground Doctrine Steps. Goal: Organize/Inform. Viz/Method: Numbered list with distinct styling. Interaction: None. Justification: Clearly outlines sequential requirements. Method: HTML/Tailwind.
        - Report Info: Search & Seizure Warrant/Exceptions. Goal: Inform/Organized. Viz/Method: Hierarchical styled HTML divs with explicit connections. Interaction: None. Justification: Structurally clarifies conditions and exceptions. Method: HTML/Tailwind.
        - Report Info: Bail Conditions, HUT heinous crimes. Goal: Inform. Viz/Method: Detailed lists within expandable sections. Interaction: None. Justification: Presents comprehensive legal requirements clearly. Method: HTML/Tailwind.
        - Report Info: Specific Legislation (Marijuana, Weapons, Speed Limits). Goal: Inform/Organized. Viz/Method: Accordion/collapsible sections for each act. Interaction: User clicks to reveal definitions, limits, enforcement. Justification: Consolidates related laws into easily browsable units. Method: HTML/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%; /* Ensure html and body take full viewport height */
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            /* Global box-sizing for consistent layout calculations */
            box-sizing: border-box; 
        }
        *, *::before, *::after {
            box-sizing: inherit; /* Inherit box-sizing for all elements */
        }
        /* Default nav item styling for better visibility on dark background */
        .nav-item {
            color: #d1d5db; /* text-gray-300 for better visibility */
        }
        .nav-item.active {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* Accordion styles */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
            padding-left: 1rem; /* Added padding to shift collapsed/uncollapsed content */
            padding-right: 1rem; /* Also add right padding for symmetry */
        }
        .accordion-content.expanded {
            max-height: 1000px; /* Increased max-height to accommodate new content */
            opacity: 1;
            padding-top: 1rem; /* Matches px-4 (16px) */
            padding-bottom: 1rem; /* Matches pb-4 (16px) */
            /* padding-left and padding-right are already set in the base .accordion-content */
        }
        /* clearfix utility to contain floated elements */
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }
        /* Style for multi-select dropdown */
        select[multiple] {
            height: auto; /* Allow height to adjust based on content */
            min-height: 250px; /* Increased min-height for better visibility */
            overflow-y: auto; /* Enable scrolling if many options */
            padding: 0.5rem; /* Add some padding */
            border-radius: 0.375rem; /* rounded-md */
        }

        /* Custom styles for charge categories in dropdown */
        .charge-felony {
            background-color: #fee2e2; /* Red-100 */
            color: #ef4444; /* Red-500 */
        }
        .charge-misdemeanor {
            background-color: #fffbeb; /* Yellow-100 */
            color: #f59e0b; /* Yellow-600 */
        }
        .charge-citation {
            background-color: #d1fae5; /* Green-100 */
            color: #10b981; /* Green-500 */
        }
        /* Ensure selected options maintain color */
        select[multiple] option:checked {
            background-color: #bfdbfe; /* Blue-200 for selected */
            color: #1e40af; /* Blue-800 for selected text */
        }
        /* Mobile sidebar specific styles */
        .mobile-sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent overlay */
            z-index: 40; /* Above main content, below sidebar */
            display: none; /* Hidden by default */
        }
        .mobile-sidebar-overlay.active {
            display: block; /* Visible when sidebar is active */
        }
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 80%; /* Adjust as needed */
            max-width: 320px; /* Max width for sidebar on mobile */
            height: 100%;
            background-color: #1f2937; /* bg-gray-800 */
            transform: translateX(-100%); /* Start off-screen */
            transition: transform 0.3s ease-in-out;
            z-index: 50; /* Above overlay */
            box-shadow: 2px 0 5px rgba(0,0,0,0.5);
            display: flex; /* Ensure flex for internal layout */
            flex-direction: column; /* Ensure column for internal layout */
        }
        .mobile-sidebar.active {
            transform: translateX(0); /* Slide in */
        }

        /* Modal specific styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 100; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 1.5rem;
            border-radius: 0.5rem;
            width: 90%;
            max-width: 700px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            max-height: 90vh;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }

        .modal-body {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .modal-footer {
            border-top: 1px solid #e5e7eb;
            padding-top: 1rem;
            margin-top: 1rem;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        .close-button {
            color: #aaa;
            font-size: 1.875rem;
            font-weight: bold;
            cursor: pointer;
        }
        .close-button:hover,
        .close-button:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .charges-list-item, .reduction-list-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            border-radius: 0.375rem;
            margin-bottom: 0.25rem;
        }

        .charges-list-item:hover {
            background-color: #f0f4f8; /* Light blue on hover */
        }

        .charges-list-item.selected { /* New style for selected items */
            background-color: #dbeafe; /* Blue-100 */
            border-left: 4px solid #3b82f6; /* Blue-500 border */
            font-weight: 500;
        }

        .charges-list-item input[type="checkbox"], .reduction-list-item input[type="radio"] {
            margin-right: 0.75rem;
            transform: scale(1.2);
        }

        /* Style for text input that acts as a dropdown trigger */
        .dropdown-display {
            background-color: white;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            padding: 0.625rem 1rem;
            min-height: 42px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: #4b5563;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .dropdown-display:hover {
            border-color: #60a5fa;
        }

        .dropdown-display:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.5);
        }

        /* Specific styles for job detail pages to handle consistent display */
        .job-detail-section {
            display: none;
        }
        .job-detail-section.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col h-screen">

    <!-- Mobile Navigation Toggle Button - Only visible on small screens -->
    <div class="md:hidden p-4 bg-gray-800 text-white flex items-center justify-between">
        <button id="mobile-nav-toggle" class="focus:outline-none">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
        <span class="text-lg font-bold">DOJ Guide</span>
    </div>

    <!-- Mobile Sidebar Overlay -->
    <div id="mobile-sidebar-overlay" class="mobile-sidebar-overlay"></div>

    <!-- Main Container with Responsive Flex Layout -->
    <div class="flex flex-col md:flex-row flex-1 bg-gray-100">
        <!-- Desktop Sidebar - Always present, visible on medium and up -->
        <aside id="desktop-sidebar" class="w-64 bg-gray-800 text-white flex-shrink-0 hidden md:flex flex-col">
            <div class="p-4 border-b border-gray-700">
                <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="w-16 h-16 mr-2 mb-2 rounded-full float-left" onerror="this.onerror=null; this.src='https://placehold.co/64x64/cccccc/000000?text=Image+Error';">
                <div class="overflow-hidden">
                    <h1 class="text-xl font-bold pt-2">Department of Justice Information System</h1>
                    <p class="text-xs text-gray-400">Elevate RP Jurisdiction</p>
                </div>
            </div>
            <nav class="mt-4 overflow-y-auto flex-1">
                <a href="#introduction" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">👋</span> Introduction
                </a>
                <a href="#sentencing-guidelines" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📊</span> Sentencing Guidelines
                </a>
                <a href="#charge-calculator" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🧮</span> Reduction Calculator
                </a>
                <a href="#constitution" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📜</span> Constitution & Rights
                </a>
                <a href="#laws" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📖</span> Specific Legislation
                </a>
                <a href="#dueprocess" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">⚖️</span> Due Process & Court
                </a>
                <a href="#search" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🔍</span> Search & Seizure
                </a>
                <a href="#foia" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📂</span> FOIA & Evidence
                </a>
                <a href="#caselaw" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📚</span> Case Law Library
                </a>
                <a href="#strategy" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🎯</span> Strategic Defense
                </a>
                <a href="#courtroom" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🧑‍⚖️</span> Courtroom Procedures & Objections
                </a>
                <a href="#tools" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🛠️</span> Legal Tools & Admin
                </a>
                <a href="#leos" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">👮</span> LEO Powers & Definitions
                </a>
                <a href="#important-links" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🔗</span> Important Links
                </a>
            </nav>
            <!-- Site-wide footer for desktop sidebar -->
            <footer class="p-4 text-xs text-gray-400 border-t border-gray-700 mt-auto text-center">
                This is a fictional site made for a FiveM server Elevate RP.
            </footer>
        </aside>

        <!-- Mobile Sidebar - Only appears on small screens, slides in. Hidden on md and up. -->
        <div id="mobile-sidebar-content" class="mobile-sidebar md:hidden">
            <div class="p-4 border-b border-gray-700">
                <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="w-16 h-16 mr-2 mb-2 rounded-full float-left" onerror="this.onerror=null; this.src='https://placehold.co/64x64/cccccc/000000?text=Image+Error';">
                <div class="overflow-hidden">
                    <h1 class="text-xl font-bold pt-2">Department of Justice Information System</h1>
                    <p class="text-xs text-gray-400">Elevate RP Jurisdiction</p>
                </div>
            </div>
            <nav class="mt-4 overflow-y-auto flex-1">
                <a href="#introduction" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">👋</span> Introduction
                </a>
                <a href="#sentencing-guidelines" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📊</span> Sentencing Guidelines
                </a>
                <a href="#charge-calculator" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🧮</span> Reduction Calculator
                </a>
                <a href="#constitution" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📜</span> Constitution & Rights
                </a>
                <a href="#laws" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📖</span> Specific Legislation
                </a>
                <a href="#dueprocess" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">⚖️</span> Due Process & Court
                </a>
                <a href="#search" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🔍</span> Search & Seizure
                </a>
                <a href="#foia" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📂</span> FOIA & Evidence
                </a>
                <a href="#caselaw" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">📚</span> Case Law Library
                </a>
                <a href="#strategy" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🎯</span> Strategic Defense
                </a>
                <a href="#courtroom" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🧑‍⚖️</span> Courtroom Procedures & Objections
                </a>
                <a href="#tools" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🛠️</span> Legal Tools & Admin
                </a>
                <a href="#leos" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">👮</span> LEO Powers & Definitions
                </a>
                <a href="#important-links" class="nav-item flex items-center px-4 py-3 hover:bg-gray-700 transition duration-150">
                    <span class="mr-3">🔗</span> Important Links
                </a>
            </nav>
            <!-- Site-wide footer for mobile sidebar -->
            <footer class="p-4 text-xs text-gray-400 border-t border-gray-700 mt-auto text-center">
                This is a fictional site made for a FiveM server Elevate RP.
            </footer>
        </div>

        <!-- Main Content Area - Takes full width on small screens -->
        <main class="flex-1 p-6 md:p-8 lg:p-10 overflow-y-auto w-full">
            <!-- Content Wrapper to constrain width on large monitors -->
            <div class="max-w-screen-xl mx-auto">
                
                <div id="introduction" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Welcome to the Department of Justice Information System</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <p class="text-lg leading-relaxed mb-4">Welcome to the Department of Justice’s foundational guide for defense attorneys. This interactive tool is designed as a comprehensive learning resource to empower legal professionals within the Elevate RP jurisdiction. Its primary purpose is to provide clear, accessible, and practical information on legal concepts, defense strategies, procedural protections, and relevant case law, ensuring that attorneys can effectively represent their clients in an adversarial legal system. This guide aims to streamline research, enhance tactical decision-making, and promote a deeper understanding of legal precedents.</p>
                        
                        <h3 class="text-xl font-bold mb-2">Creator & Key DOJ Positions</h3>
                        <p class="text-gray-700 mb-4">This interactive learning tool was created by <strong>Mike Ross</strong>, the Deputy Chief Justice of the Department of Justice.</p>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                                <h4 class="font-semibold text-lg mb-2 text-blue-800 cursor-pointer job-title-link" data-target="job-chief-justice">Chief Justice - Luis Salamanca</h4>
                                <p class="text-gray-700 text-sm">In charge of legislation, oversees Defense Attorneys, conducts DOJ Policy Reviews, handles administrative work, and is responsible for warrant and other legal document verification, approval, or review.</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                                <h4 class="font-semibold text-lg mb-2 text-green-800 cursor-pointer job-title-link" data-target="job-deputy-chief-justice">Deputy Chief Justice - Mike Ross</h4>
                                <p class="text-gray-700 text-sm">In charge of The District Attorney's office, conducts DOJ Policy Reviews, handles administrative work, is responsible for interpretation of laws, oversees prosecution of criminal cases, reviews civil cases, and is a member of the State Bar Review Board.</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                                <h4 class="font-semibold text-lg mb-2 text-purple-800 cursor-pointer job-title-link" data-target="job-chief-prosecutor">Chief Prosecutor</h4>
                                <p class="text-gray-700 text-sm">Goes to court, handles paperwork, guides the Unified Police Department, and supervises the District Attorneys, including their assignments, promotions, and roles.</p>
                            </div>
                            <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                                <h4 class="font-semibold text-lg mb-2 text-red-800 cursor-pointer job-title-link" data-target="job-district-attorney">District Attorney</h4>
                                <p class="text-gray-700 text-sm">In charge of the District Attorney's Office, goes to court, handles paperwork, provides guidance to the Unified Police Department, and supervises the Assistant District Attorneys, including their assignments, promotions, and roles.</p>
                            </div>
                            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                                <h4 class="font-semibold text-lg mb-2 text-yellow-800 cursor-pointer job-title-link" data-target="job-defense-attorney">Defense Attorney</h4>
                                <p class="text-gray-700 text-sm">Handles criminal and civil cases for any private citizen or resident of San Andreas, assists with marriage licenses, divorce filing, adoption, weapons licenses, expungement hearings, and other important legal matters in the state of San Andreas.</p>
                            </div>
                            <div class="bg-teal-50 p-4 rounded-lg border border-teal-200">
                                <h4 class="font-semibold text-lg mb-2 text-teal-800">Municipal Security</h4>
                                <p class="text-gray-700 text-sm">Tasked with guarding the courthouse, provides bailiff services to the court, protects DOJ leadership and staff outside the courthouse when on official business, and has no arrest powers outside of the courthouse.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="sentencing-guidelines" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Sentencing Guidelines & Penalties</h2>
                    </div>
                    <p class="mb-6 text-gray-600">This section provides an overview of various charges, their categories, and typical sentencing guidelines in months, along with associated fines. Understanding these benchmarks is crucial for negotiating pleas, advising clients on potential outcomes, and challenging disproportionate sentences. The charts below visualize median sentencing times and fines across different charge categories.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
                        <h3 class="font-bold text-xl mb-4 text-center">Charge Penalties Overview</h3>
                        <p class="text-md text-gray-700 mb-4 text-center">Total Charges in List: <span id="totalChargesCount" class="font-bold text-blue-700"></span></p>
                        <div class="overflow-x-auto mb-6">
                            <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Code</th>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Charge</th>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Description</th>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Category</th>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Prison Time (Months)</th>
                                        <th class="py-2 px-4 border-b text-left text-sm font-semibold text-gray-700">Fine ($)</th>
                                    </tr>
                                </thead>
                                <tbody id="sentencingTableBody">
                                    <!-- Data will be inserted here by JavaScript -->
                                </tbody>
                            </table>
                        </div>

                        <h3 class="font-bold text-xl mb-4 text-center">Median Sentencing & Fine by Category</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="chart-container h-64 md:h-80">
                                <canvas id="medianSentencingChart"></canvas>
                            </div>
                            <div class="chart-container h-64 md:h-80">
                                <canvas id="medianFinesChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- New section for the calculator -->
                <div id="charge-calculator" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Charge Reduction Calculator</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6 min-h-[calc(100vh-150px)]">
                        <div class="md:col-span-1">
                            <h3 class="font-bold text-xl mb-4">Select Charge(s) & Reduction</h3>
                            <div class="mb-4">
                                <label for="chargeSelectionDisplay" class="block text-sm font-medium text-gray-700 mb-2">
                                    Selected Charge(s):
                                </label>
                                <div id="chargeSelectionDisplay" class="dropdown-display">
                                    <span>No charges selected</span>
                                    <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label for="reductionSelectionDisplay" class="block text-sm font-medium text-gray-700 mb-2">
                                    Selected Reduction Percentage:
                                </label>
                                <div id="reductionSelectionDisplay" class="dropdown-display">
                                    <span>No Reduction (0%)</span>
                                    <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </div>
                            </div>
                            <button id="applyReductionBtn" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Calculate Reduction</button>
                        </div>
                        <div class="md:col-span-1 bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="font-bold text-xl mb-4">Calculated Reductions</h3>
                            <div id="reductionResults" class="space-y-4 h-64 overflow-y-auto">
                                <div class="p-3 border border-blue-200 rounded-md bg-blue-50">
                                    <p class="text-gray-600">Select charges and a reduction to see results.</p>
                                </div>
                            </div>
                            <div id="totalResults" class="mt-6 pt-4 border-t border-gray-300 hidden">
                                <h4 class="font-bold text-lg mb-2">Final Totals</h4>
                                <p>Total Sentencing: <span id="finalTotalSentencing" class="font-bold text-green-800"></span></p>
                                <p>Total Fine: <span id="finalTotalFine" class="font-bold text-green-800"></span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charge Selection Modal -->
                <div id="chargeSelectionModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="text-2xl font-bold">Select Charges</h3>
                            <span class="close-button" id="closeChargeModal">&times;</span>
                        </div>
                        <div class="mb-4">
                            <input type="text" id="chargeSearchInput" placeholder="Search charges..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="modal-body">
                            <div id="chargesList" class="space-y-1">
                                <!-- Charges will be dynamically loaded here -->
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button id="clearAllChargesBtn" class="bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">Clear All Charges</button>
                            <button id="applySelectedChargesBtn" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Apply Selection</button>
                        </div>
                    </div>
                </div>

                <!-- Reduction Selection Modal -->
                <div id="reductionSelectionModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="text-2xl font-bold">Select Reduction Percentage</h3>
                            <span class="close-button" id="closeReductionModal">&times;</span>
                        </div>
                        <div class="modal-body">
                            <div id="reductionOptionsList" class="space-y-1">
                                <!-- Reduction options will be dynamically loaded here -->
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="0" class="form-radio h-5 w-5 text-blue-600" checked>
                                    <span class="text-sm font-medium text-gray-900">No Reduction (0%)</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="5" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">5% Reduction</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="10" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">10% Reduction</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="25" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">25% Reduction</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="50" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">50% Reduction</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="75" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">75% Reduction</span>
                                </label>
                                <label class="reduction-list-item">
                                    <input type="radio" name="reductionOption" value="custom" class="form-radio h-5 w-5 text-blue-600">
                                    <span class="text-sm font-medium text-gray-900">Custom Percentage</span>
                                </label>
                                <div id="customReductionInputModalDiv" class="mt-4 p-2 border border-gray-300 rounded-md hidden">
                                    <label for="customReductionInputModal" class="block text-xs font-medium text-gray-700 mb-1">Enter Custom Percentage (0-100):</label>
                                    <input type="number" id="customReductionInputModal" min="0" max="100" class="w-full p-1 border border-gray-300 rounded-md text-sm" placeholder="e.g., 15">
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <!-- No clear button needed for single selection radio buttons -->
                            <button id="applySelectedReductionBtn" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Apply Selection</button>
                        </div>
                    </div>
                </div>

                <div id="constitution" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">San Andreas Constitution & Core Constitutional Rights</h2>
                    </div>
                    <p class="mb-6 text-gray-600">This section provides an overview of the San Andreas Constitution and the fundamental constitutional rights that underpin all legal defense. Understanding and effectively invoking these rights is paramount to safeguarding client liberty. Each card below details a key right and its practical application in challenging the state's actions.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
                        <h3 class="font-bold text-xl mb-2">Preamble & Articles I-II Highlights</h3>
                        <p class="text-gray-600">The San Andreas Constitution establishes justice, ensures tranquility, and secures liberty. It is the supreme law, requiring citizen adherence and tax payment. Article II defines legislative authorities: DOJ (supreme legal authority, sets common law precedents), Blaine County, Los Santos County, and San Andreas Medical Services (SAMS) with their respective jurisdictions and responsibilities. Cross-jurisdictional agreements can form state-wide law.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Fair Trial and Due Process</h3>
                            <p class="text-gray-600">All citizens are guaranteed a fair trial and due process of law. Use this right to challenge unlawful detentions, delays in arraignment, or inadequate disclosures by the prosecution.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Privacy</h3>
                            <p class="text-gray-600">Citizens have the right to personal privacy and protection from unwarranted disclosure of private information. Enforce this right when contesting overbroad or warrantless searches.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Dignity and Equal Treatment</h3>
                            <p class="text-gray-600">All citizens shall be treated equally and with respect, free from discrimination. Also covers the right to health services and to protect themselves and others within reason.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Free Speech and Thought</h3>
                            <p class="text-gray-600">Citizens are free to express their thoughts and beliefs without censorship or coercion, provided it does not hinder the rights of others.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Right to Property</h3>
                            <p class="text-gray-600">Citizens have the right to own material possessions and land, provided it does not infringe on others' rights.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h3 class="font-bold text-xl mb-2">Right to Information</h3>
                            <p class="text-gray-600">Citizens have the right to access public information necessary for their well-being. This is the basis for FOIA requests.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-green-500 col-span-1 md:col-span-2 lg:col-span-3">
                            <h3 class="font-bold text-xl mb-2">Attorney-Client Privilege</h3>
                            <p class="text-gray-600">A critical right that safeguards all forms of confidential communications between a lawyer and client for legal advice. A breach is immediate grounds for a mistrial motion.</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-orange-500 col-span-1 md:col-span-2 lg:col-span-3">
                            <h3 class="font-bold text-xl mb-2">Sixth Amendment Rights (Criminal Prosecutions)</h3>
                            <p class="text-gray-600">In all criminal prosecutions, the accused shall enjoy the right to a speedy and public trial, by an impartial jury of the State and district wherein the crime shall have been committed, which district shall have been previously ascertained by law, and to be informed of the nature and cause of the accusation; to be confronted with the witnesses against him; to have compulsory process for obtaining witnesses in his favor, and to have the Assistance of Counsel for his defence.</p>
                            <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 mt-2">
                                <li><span class="font-bold">Speedy and Public Trial:</span> Ensures that trials are not unduly delayed and are open to the public, preventing secret proceedings.</li>
                                <li><span class="font-bold">Impartial Jury:</span> Guarantees a fair trial by a jury free from bias, drawn from the jurisdiction where the crime occurred.</li>
                                <li><span class="font-bold">Notice of Accusation:</span> The defendant must be clearly informed of the specific charges and evidence against them.</li>
                                <li><span class="font-bold">Confrontation of Witnesses:</span> The right to face and cross-examine witnesses who testify against them.</li>
                                <li><span class="font-bold">Compulsory Process (Subpoenas):</span> The power to compel witnesses to appear and testify on their behalf.</li>
                                <li><span class="font-bold">Assistance of Counsel:</span> The right to an attorney, including having one provided if the defendant cannot afford one, for all critical stages of the criminal process.</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="laws" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Specific Legislation Highlights</h2>
                    </div>
                    <p class="mb-6 text-gray-600">This section delves into specific legislative acts that directly impact defense strategy. Click on each act to understand its core purpose, constitutional justification, and key details including legal limits, enforcement, and penalties. This knowledge is crucial for crafting effective defenses tailored to specific charges.</p>
                    <div class="space-y-4">
                        <!-- Marijuana Decriminalization Act -->
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left bg-blue-500 text-white rounded-t-lg">
                                <span>Marijuana Decriminalization Act</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <h4 class="font-bold text-lg mt-4 mb-2">Purpose & Justification</h4>
                                <p class="text-gray-700 text-sm">Legalizes possession of small amounts for personal use to focus law enforcement on serious crimes. Justified by individual freedoms related to health, privacy, and dignity (Constitution Article III).</p>
                                <h4 class="font-bold text-lg mt-4 mb-2">Key Details</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Legal Limits: Up to 4 marijuana joints (max 1g each) OR up to 6 weed baggies (max 1g each). Assortments allowed following charted totals (not charted here but noted).</li>
                                    <li>Enforcement: Law enforcement assumed to be within legal quantity by default. NO probable cause for detention/search based on marijuana possession alone, without articulable probable cause exceeding limits. Smoking/displaying alone does not invoke Reasonable Suspicion or Probable Cause for further investigation.</li>
                                    <li>Penalties: Quantities exceeding limits are subject to fines, misdemeanor, or felony charges.</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Weapons & Driver's License Legislation -->
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left bg-blue-500 text-white rounded-t-lg">
                                <span>Weapons & Driver's License Legislation</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <h4 class="font-bold text-lg mt-4 mb-2">Purpose & Justification</h4>
                                <p class="text-gray-700 text-sm">Regulates firearm ownership for public safety while upholding citizens' right to self-defense (Constitutional Justification: Self-defense and protection of others).</p>
                                <h4 class="font-bold text-lg mt-4 mb-2">Key Details - Weapons</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Permitted Firearms (Class 1): Ruger 57 Pistol, Snub Nose Revolver, Tan 1911 Pistol (purchased from Courthouse). Other firearms are strictly prohibited.</li>
                                    <li>Prohibited Actions: Unlawful use (threats/assaults), selling/transferring/gifting, false reporting stolen, straw purchasing.</li>
                                    <li>Class 2/3 Weapons: NOT covered by license. Class 2: Full-automatic. Class 3: Heavy assault rifle, machine gun, full-auto with >30 bullet mag. Possession/use punishable by law.</li>
                                    <li>License Removal: Conviction of violent felony/misdemeanor, violation of prohibited actions, sufficient probable cause of committing violent felonies/misdemeanors (by Judge/Justice).</li>
                                </ul>
                                <h4 class="font-bold text-lg mt-4 mb-2">Key Details - Driver's License</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Suspension: Accumulation of 20 points leads to driving on suspended license.</li>
                                    <li>Point Reduction: Points reduced by 5 every two weeks.</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Speed Limits -->
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left bg-blue-500 text-white rounded-t-lg">
                                <span>Speed Limits</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <h4 class="font-bold text-lg mt-4 mb-2">Purpose & Justification</h4>
                                <p class="text-gray-700 text-sm">Standardizes speed limits for enhanced traffic flow and safety. Justified by the Right to Health and Protection of Others (Constitution Article III).</p>
                                <h4 class="font-bold text-lg mt-4 mb-2">Maximum Speed Limits</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Los Santos City: 50 mph</li>
                                    <li>Blaine County Roads (incl. Route 68, Joshua, Sustancia): 75 mph</li>
                                    <li>Highways & Freeways: 80 mph</li>
                                </ul>
                                <p class="text-gray-700 text-sm mt-2">Fines for moving violations are increased proportionally to reflect these limits and promote safer driving.</p>
                            </div>
                        </div>

                        <!-- Stand Your Ground Doctrine -->
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left bg-blue-500 text-white rounded-t-lg">
                                <span>Stand Your Ground Doctrine</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <h4 class="font-bold text-lg mt-4 mb-2">Purpose & Justification</h4>
                                <p class="text-gray-700 text-sm">Details reasonable steps for self-protection under threat of serious injury/death. Justified by the Right to Health and Protection of Others (Constitution Article III).</p>
                                <h4 class="font-bold text-lg mt-4 mb-2">Application: Reasonable Steps (if safe/reasonable)</h4>
                                <ol class="list-decimal list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Issue a Verbal Warning to aggressor.</li>
                                    <li>Brandish a Weapon to be utilized in Self-Defense.</li>
                                    <li>Attempt to Walk Away/Escape the situation.</li>
                                </ol>
                                <p class="text-700 text-sm mt-2">If deadly force is used, contact emergency services, remain on scene, and cooperate with Law Enforcement and Emergency Responders.</p>
                            </div>
                        </div>

                        <!-- Good Samaritan Act -->
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left bg-blue-500 text-white rounded-t-lg">
                                <span>Good Samaritan Act</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <h4 class="font-bold text-lg mt-4 mb-2">Overview</h4>
                                <p class="text-gray-700 text-sm">This document serves as an official announcement regarding the introduction and implementation of the Good Samaritan Act within the jurisdiction of Los Santos. As of [4/8/2025], the City of Los Santos has formally adopted the Good Samaritan Act, which provides legal protection to individuals who voluntarily offer assistance during emergencies.</p>
                                
                                <h4 class="font-bold text-lg mt-4 mb-2">Key Provisions of the Act</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li><span class="font-bold">Legal Protection:</span> Individuals who act in good faith to provide assistance will not be held legally liable for any harm or damages that may occur as a result of their help, provided their actions are reasonable and not intentional or grossly negligent.</li>
                                    <li><span class="font-bold">Scope of Assistance:</span> The protections apply to a wide range of emergency interventions, including but not limited to:
                                        <ul class="list-circle list-inside ml-4 text-gray-700 text-sm">
                                            <li>Offering medical aid, such as performing CPR or first aid.</li>
                                            <li>Assisting in rescue efforts during accidents or natural disasters.</li>
                                            <li>Helping individuals in distress or those at risk of immediate harm.</li>
                                        </ul>
                                    </li>
                                    <li><span class="font-bold">Limits of Protection:</span> The Good Samaritan Act does not protect individuals who act with gross negligence, recklessness, or intentional harm during their intervention.</li>
                                </ul>

                                <h4 class="font-bold text-lg mt-4 mb-2">Benefits of the Good Samaritan Act</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li><span class="font-bold">Encouraging prompt action:</span> People can now act without fear of legal repercussions when they are the first to arrive at an emergency scene.</li>
                                    <li><span class="font-bold">Improving community safety:</span> With more individuals willing to intervene in emergencies, the overall safety and wellbeing of the community will be improved.</li>
                                    <li><span class="font-bold">Promoting compassion:</span> The law supports altruistic behavior and reinforces the value of helping others during times of crisis.</li>
                                </ul>

                                <h4 class="font-bold text-lg mt-4 mb-2">Recommendations for Those Providing Assistance</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li><span class="font-bold">Provide aid to the best of your ability:</span> Offer assistance within the limits of your knowledge and training (e.g., first aid, CPR, or basic rescue techniques).</li>
                                    <li><span class="font-bold">Contact Professional Services:</span> In any emergency, it is highly recommended to immediately contact Los Santos Emergency Services (EMS, Fire Department, Police) to ensure that trained professionals can take over once they arrive.</li>
                                    <li><span class="font-bold">Act Reasonably and Safely:</span> Always consider the safety of yourself and others when providing assistance.</li>
                                </ul>

                                <h4 class="font-bold text-lg mt-4 mb-2">Limitations and Legal Responsibility</h4>
                                <ul class="list-disc list-inside text-gray-700 space-y-1 text-sm">
                                    <li>Protection is limited to individuals acting in good faith and without compensation.</li>
                                    <li>Individuals found to be acting with gross negligence or recklessness, or with intentional harm, will still be subject to legal consequences, including civil suits or criminal charges.</li>
                                </ul>

                                <p class="text-gray-700 text-sm mt-4">The Good Samaritan Act will be effective starting [4/8/2025]. From this date forward, all individuals providing emergency assistance within the jurisdiction of Los Santos will be afforded the protections outlined by this law, provided they meet the criteria specified above.</p>
                                <p class="text-gray-700 text-sm mt-2">The introduction of the Good Samaritan Act marks a significant step forward in ensuring that individuals are protected when they step in to help others during emergencies. Los Santos encourages all residents and visitors to continue fostering a spirit of compassion and assistance, knowing that they are legally supported when doing so.</p>
                                <p class="text-gray-700 text-sm mt-2">For more information or any questions regarding the specifics of the Good Samaritan Act, please contact the Los Santos Department of Legal Affairs or visit the official city website.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="dueprocess" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Deep Dive: Due Process & Court Proceedings</h2>
                    </div>
                    <p class="mb-6 text-gray-600">This section provides an in-depth look at due process, court procedures, and crucial legal nuances. It covers everything from investigative holds and trial outcomes to attorney-client confidentiality and double jeopardy. The information here is vital for understanding the procedural landscape and identifying opportunities for defense.</p>
                    <div class="space-y-6">
                        <!-- Statute of Limitations -->
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="font-bold text-xl mb-3 text-center">Statute of Limitations</h3>
                            <p class="text-gray-600 mb-4 text-sm text-center">Law Enforcement has 15 days from crime commission to press charges or collect evidence. Exceptions apply for delayed discovery.</p>
                            <div class="chart-container h-64 md:h-80">
                                <canvas id="limitationsChart"></canvas>
                            </div>
                            <ul class="mt-4 list-disc list-inside text-gray-600 text-sm space-y-1">
                                <li>Charges & Warrants: 15 days from crime to press charges or serve warrant. For continuous crimes, limit starts from last act.</li>
                                <li>Evidence: Must be collected within 15 days prior to charges. Older evidence may be admissible if directly impacts understanding of current crime and corroborated by current evidence within 15 days.</li>
                                <li>Exceptions: Charges by DOJ (Contempt, FTA, Violating Order) are exempt. Delayed Discovery Rule (Section 5) allows for later discovery.</li>
                            </ul>
                        </div>

                        <!-- Investigative Holds & Writ of Habeas Corpus -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-yellow-500">
                                <h3 class="font-bold text-xl mb-3">Investigative Holds</h3>
                                <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                                    <li>PD Command: Up to 30 minutes.</li>
                                    <li>Judicial Approval: Not to exceed 1 hour total.</li>
                                    <li class="font-semibold">Must be supported by reasonable suspicion.</li>
                                </ul>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-red-500">
                                <h3 class="font-bold text-xl mb-3">Writ of Habeas Corpus</h3>
                                <p class="text-gray-600 text-sm">Request release if client held for 72 hours without formal charges filed (excluding approved investigative holds).</p>
                            </div>
                        </div>

                        <!-- Hold Until Trial (HUT) -->
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-purple-500">
                            <h3 class="font-bold text-xl mb-3">Hold Until Trial (HUT) Guidelines</h3>
                            <p class="text-gray-600 mb-2 text-sm">Permissible only for heinous crimes. Max hold without arraignment: 7 days. Charges must be docketed within 72 hours.</p>
                            <h4 class="font-bold text-md mb-2">Defined Heinous Acts:</h4>
                            <ul class="list-disc list-inside text-gray-600 grid grid-cols-1 md:grid-cols-2 gap-x-4 text-sm">
                                <li>Serial Assaults and Killings</li>
                                <li>1st Degree Targeted Violence</li>
                                <li>Attempted Murder</li>
                                <li>Witness Tampering/Intimidation</li>
                                <li>Harboring a Fugitive</li>
                                <li>Terrorism</li>
                                <li>Treason</li>
                                <li>Weapons Trafficking</li>
                                <li>Major Drug Trafficking</li>
                            </ul>
                        </div>

                        <!-- Bail Conditions -->
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-indigo-500">
                            <h3 class="font-bold text-xl mb-3">Bail Conditions</h3>
                            <p class="mb-3 text-sm">Standard conditions mirror probation terms. Violation leads to immediate remand with no appeal.</p>
                            <h4 class="font-bold text-md mb-2">Standard Conditions:</h4>
                            <ul class="list-disc list-inside space-y-1 text-gray-600 text-sm">
                                <li>Residence restrictions (no change without court permission).</li>
                                <li>No intoxicants to excess; may be subject to testing.</li>
                                <li>No controlled substances without prescription; may be subject to testing.</li>
                                <li>No possession of any weapon, regardless of license.</li>
                                <li>Cooperation with Law Enforcement and Court.</li>
                                <li>Electronic Ankle Monitor Supervision (24/7 tracking).</li>
                                <li>Compliance with all institutional rules (e.g., Penal Code).</li>
                                <li>Submit to search of person/auto by Court/Parole Officer at any time day or night, without warrant, upon reasonable cause as ascertained by the Assigned Parole Officer or the Court presiding over the case.</li>
                            </ul>
                            <p class="mt-3 text-sm italic">These may be modified by presiding Judge/Justice. Violation is at Judge/Justice sole discretion; no appeal.</p>
                        </div>

                        <!-- Mistrials -->
                        <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-teal-500">
                            <h3 class="font-bold text-xl mb-3">Mistrials</h3>
                            <p class="text-gray-600 text-sm">Declared by a Judicial Power presiding over the case or a DOJ Justice. All Judicial Powers or attorneys are REQUIRED to motion for a mistrial if any rights (especially Due Process) are violated during proceedings.</p>
                            <p class="mt-2 text-sm italic">A mistrial terminates the trial without a verdict, allowing the case to be rescheduled.</p>
                        </div>

                        <!-- Attorney Client Confidentiality & Double Jeopardy -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-pink-500">
                                <h3 class="font-bold text-xl mb-3">Attorney-Client Confidentiality</h3>
                                <p class="text-gray-600 text-sm">Protects confidential communications (verbal, written, electronic) between lawyer and client related to legal advice or services.</p>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-orange-500">
                                <h3 class="font-bold text-xl mb-3">Double Jeopardy</h3>
                                <p class="text-gray-600 text-sm">Citizens shall not be prosecuted twice for the same criminal incident.</p>
                                <p class="mt-2 text-sm italic">Exception: Delayed Death Exception - if victim of violent felony/attempted murder dies later from injuries, charge may be revisited and re-tried with new appropriate charge.</p>
                            </div>
                        </div>

                        <!-- Court Proceedings & Appeals -->
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="font-bold text-xl mb-3 text-center">Court Proceedings & Appeals</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold text-lg mb-2">Bench Trials</h4>
                                    <p class="text-gray-600 text-sm">Begin at discretion of a ready Judicial member. If stemming from a warrant, Defendant can request a Bench Review (Judicial review of warrant veracity) before full trial.</p>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-lg mb-2">Appeals</h4>
                                    <p class="text-gray-600 text-sm">Every citizen has the right to appeal charges (unless dismissed/adjourned with prejudice). Appeals must be filed within 15 days of charges placed or case dismissal/adjournment without prejudice. Citizens may only appeal once.</p>
                                </div>
                            </div>
                            <h3 class="font-bold text-xl mt-6 mb-4 text-center">Trial Outcomes</h3>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead class="bg-gray-200 text-gray-700">
                                        <tr>
                                            <th class="p-3 font-semibold">Outcome</th>
                                            <th class="p-3 font-semibold">Meaning</th>
                                            <th class="p-3 font-semibold">Legal Effect</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b">
                                            <td class="p-3 font-medium text-green-600">Guilty</td>
                                            <td class="p-3">Conviction by fact or plea</td>
                                            <td class="p-3">Sentencing follows</td>
                                        </tr>
                                        <tr class="border-b">
                                            <td class="p-3 font-medium text-red-600">Not Guilty</td>
                                            <td class="p-3">Acquittal</td>
                                            <td class="p-3">Client is released</td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 font-medium text-yellow-600">Mistrial</td>
                                            <td class="p-3">No verdict; retrial permissible</td>
                                            <td class="p-3">Case is restarted</td>
                                        </tr>
                                        <tr>
                                            <td class="p-3 font-medium text-blue-600">Civil Outcomes</td>
                                            <td class="p-3">Various (monetary, punitive, restorative damages, asset forfeiture, compelled actions)</td>
                                            <td class="p-3">Judge/Justice determines relief</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="search" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Search & Seizure Protocols</h2>
                    </div>
                    <p class="mb-6 text-gray-600">Protecting clients from unlawful searches is a primary function of a defense attorney. This section outlines the strict requirements for a valid warrant and the specific, narrow exceptions where a warrantless search may be lawful. Always challenge searches that fall outside these clear boundaries.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-2xl mb-4 text-center">Search & Seizure Framework</h3>
                        <div class="space-y-6">
                            <div class="p-4 bg-blue-100 border-2 border-blue-500 rounded-lg text-center">
                                <h4 class="font-bold text-xl">General Rule: Search Warrant Required</h4>
                                <p class="text-sm mt-1">For real and private property, a duly issued and executed Search Warrant is required, absent probable cause with exigency. Must be executed within 7 spiritual days (John Doe warrants: 3 days).</p>
                                <h5 class="font-bold text-lg mt-3">Warrant Requirements:</h5>
                                <ul class="mt-2 text-left list-disc list-inside mx-auto max-w-md text-gray-700 text-sm">
                                    <li>Articulable probable cause from sworn LEO detailing crime(s).</li>
                                    <li>Articulable probable cause explaining why listed properties should be searched.</li>
                                    <li>Reasonable info supporting evidence found in properties (Officer's observations or verifiable informant).</li>
                                    <li>If warrant lacks accurate info of what is to be searched, it shall be denied.</li>
                                </ul>
                            </div>
                            <div class="flex justify-center text-2xl font-bold text-gray-500">↓ Optional Exceptions ↓</div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="p-4 bg-gray-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Plain Sight</h4>
                                    <p class="text-sm">If LEO witnesses an illegal item/circumstance from public space or during execution of another lawful warrant, scope can be expanded to include/seize these items.</p>
                                </div>
                                <div class="p-4 bg-gray-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Vehicle Exception ("Automobile Exception")</h4>
                                    <p class="text-sm">Warrantless search when probable cause exists, due to vehicle's mobility and risk of evidence destruction (Carroll v. United States).</p>
                                </div>
                                <div class="p-4 bg-gray-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Medical Safety</h4>
                                    <p class="text-sm">Search permitted for safety of transporting armed/dangerous individuals for medical care in government vehicle. Citizen can refuse, but LEO/Medical not required to transport/treat further.</p>
                                </div>
                                <div class="p-4 bg-gray-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Consent</h4>
                                    <p class="text-sm">Valid if properly documented and freely given permission to search property without warrant.</p>
                                </div>
                            </div>
                            <div class="p-4 bg-green-100 border-2 border-green-500 rounded-lg text-center">
                                <h4 class="font-bold text-xl mb-1">Search of Person/Vehicle During Detention/Arrest</h4>
                                <p class="text-sm mt-1">Subject to immediate search of person if: subject to transport/arrest to document possessions, sufficient probable cause of illegal items, or need to identify suspect. Vehicles in operation/constructive possession during crime or subject to impoundment are also subject to search without warrant.</p>
                            </div>
                            <div class="flex justify-center text-2xl font-bold text-gray-500">↓ Special Warrant Requests ↓</div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="p-4 bg-yellow-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Sealing</h4>
                                    <p class="text-sm">Personal names/records withheld from record to protect citizens.</p>
                                </div>
                                <div class="p-4 bg-yellow-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Raid</h4>
                                    <p class="text-sm">Execution of warrant without primary citizen(s) in custody.</p>
                                </div>
                                <div class="p-4 bg-yellow-100 rounded-lg border">
                                    <h4 class="font-bold text-lg mb-1">Delayed Notice</h4>
                                    <p class="text-sm">Extra time before notification of signed warrant sent to citizen(s).</p>
                                    </div>
                            </div>
                        </div>
                        <p class="mt-6 text-center font-semibold text-red-600">Defense Note: Challenge any unlawful or overly broad search as unconstitutional under state and common law.</p>
                    </div>
                </div>

                <div id="foia" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">FOIA Requests & Evidence Disclosure</h2>
                    </div>
                    <p class="mb-6 text-gray-600">The state's case is built on evidence, and you have a right to see it. This section details the formal process for requesting police reports via the Freedom of Information Act (FOIA) and the steps to take if your request is denied. Mastering this process is key to ensuring you have all necessary discovery.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-4 text-center">FOIA Request Process</h3>
                        <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 text-center">
                            <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                                <p class="font-bold">Step 1: Submit Request</p>
                                <p class="text-sm">Written communication (email/letter) to PD Dispatch/Reception/On-Duty LEO through an attorney. Must clearly describe records and include contact info.</p>
                            </div>
                            <p class="text-2xl font-bold text-blue-500">→</p>
                            <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                                <p class="font-bold">Step 2: Review Protocol</p>
                                <p class="text-sm">FOIA'd Officer acknowledges in 24 hrs. Standard review 24 hrs to check exemptions.</p>
                            </div>
                            <p class="text-2xl font-bold text-blue-500">→</p>
                            <div class="p-4 bg-gray-100 rounded-lg shadow-sm">
                                <p class="font-bold">Step 3: Response & Delivery</p>
                                <p class="text-sm">Max 3 days from request for response. Delivered via formal written documentation (email/text).</p>
                            </div>
                            <p class="text-2xl font-bold text-blue-500">→</p>
                            <div class="p-4 bg-yellow-100 rounded-lg shadow-sm">
                                <p class="font-bold">Step 4: If Denied?</p>
                                <p class="text-sm">File an appeal to a sitting Judge/Justice within 48 hours of denial. Determination made within 48 hours.</p>
                            </div>
                        </div>
                        <div class="mt-6 pt-4 border-t">
                            <h4 class="font-semibold text-lg">Exemptions & Compelling Evidence:</h4>
                            <ul class="list-disc list-inside mt-2 text-gray-600 text-sm space-y-1">
                                <li>Exemptions: Active Investigation, Active Arrest Warrant, Trade Secrets, Internal Government Communications, Warrant/Subpoena (separate provisions).</li>
                                <li>Compelling Evidence: Use subpoenas or discovery orders when FOIA is insufficient.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div id="caselaw" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Case Law Library</h2>
                    </div>
                    <p class="mb-6 text-gray-600">Landmark common law and case precedents provide powerful tools to restrict police overreach and protect client rights. This interactive library details key cases recognized in San Andreas. Click on each case name to see its core principle and how to apply it in your defense strategy to suppress improperly obtained evidence or statements, and understand the nuances of the law.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <div class="flex flex-wrap border-b mb-4">
                            <button data-case="terry" class="case-tab p-3 font-semibold border-b-2 border-blue-500 text-blue-600 flex-shrink-0">Terry v. Ohio</button>
                            <button data-case="miranda" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Miranda v. Arizona</button>
                            <button data-case="tekoh" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Tekoh v. Vega (2022)</button>
                            <button data-case="garner" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Tennessee v. Garner</button>
                            <button data-case="mimms" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Pennsylvania v. Mimms</button>
                            <button data-case="houghton" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Wyoming v. Houghton</button>
                            <button data-case="carroll" class="case-tab p-3 font-semibold text-gray-500 flex-shrink-0">Carroll v. United States</button>
                        </div>
                        <div id="case-content-area">
                            <div id="case-terry" class="case-content">
                                <h4 class="font-bold text-xl">"Stop and Frisk" Principle</h4>
                                <p class="mt-2 text-gray-600">Police may stop and frisk without probable cause for arrest if they have reasonable suspicion that the person has committed, is committing, or is about to commit a crime AND has a reasonable belief the person "may be armed and presently dangerous."</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Suppress any evidence obtained from a "stop and frisk" that was not supported by articulable reasonable suspicion of both criminal activity AND being armed/dangerous.</p>
                            </div>
                            <div id="case-miranda" class="case-content hidden">
                                <h4 class="font-bold text-xl">Custodial Interrogation Warnings</h4>
                                <p class="mt-2 text-gray-600">Statements from a defendant in custody during interrogation are admissible ONLY if law enforcement informed them of their right to remain silent and right to an attorney before interrogation, and these rights were exercised or waived knowingly, voluntarily, and intelligently.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Suppress any statements taken from a client during a custodial interrogation where Miranda warnings were not properly given.</p>
                            </div>
                            <div id="case-tekoh" class="case-content hidden">
                                <h4 class="font-bold text-xl">Un-Mirandized Statements Inadmissibility</h4>
                                <p class="mt-2 text-gray-600">Statements taken without Miranda warnings are only inadmissible if the prosecution attempts to use them for incriminating purposes. LEOs are not required to Mirandize someone if they don't intend to ask incriminating questions.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Argue for the suppression of any un-Mirandized statement if the prosecution attempts to introduce it, even indirectly, to incriminate your client. If questions are non-incriminating, the lack of Miranda may not be grounds for suppression.</p>
                            </div>
                            <div id="case-garner" class="case-content hidden">
                                <h4 class="font-bold text-xl">Deadly Force Against Fleeing Suspects</h4>
                                <p class="mt-2 text-gray-600">The use of deadly force to prevent the escape of an unarmed, non-dangerous fleeing suspect is an unreasonable seizure. Deadly force may only be used if the officer has probable cause to believe the suspect poses a significant threat of death or serious physical injury to the officer or others.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Challenge the use of deadly force if the client was unarmed and not posing a significant threat, arguing for suppression of evidence or charges related to an unlawful seizure.</p>
                            </div>
                            <div id="case-mimms" class="case-content hidden">
                                <h4 class="font-bold text-xl">Ordering Driver Out of Vehicle</h4>
                                <p class="mt-2 text-gray-600">Law enforcement may give a lawful order to the driver of a vehicle to exit the vehicle during a lawful detention (e.g., traffic stop) without infringing on the individual's rights. Officer safety is considered sufficient reason.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: While officers can order a driver out, challenge any subsequent searches or actions if they exceed the scope of the initial lawful detention, or if the initial detention itself was unlawful.</p>
                            </div>
                            <div id="case-houghton" class="case-content hidden">
                                <h4 class="font-bold text-xl">Vehicle Search & Passenger Belongings</h4>
                                <p class="mt-2 text-gray-600">If a search of a vehicle is being conducted with probable cause, law enforcement may inspect anything found within the vehicle if that item had the ability to conceal an item of interest, even if it belongs to a passenger.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Challenge if the initial probable cause for the vehicle search was lacking, or if the item searched could not reasonably conceal the object of interest (e.g., searching a small coin purse for a large weapon).</p>
                            </div>
                            <div id="case-carroll" class="case-content hidden">
                                <h4 class="font-bold text-xl">"Automobile Exception"</h4>
                                <p class="mt-2 text-gray-600">As long as law enforcement has probable cause to search a vehicle, they are not required to obtain a search warrant. This is due to the vehicle's mobility and the increased risk of evidence tampering compared to stationary property.</p>
                                <p class="mt-4 font-semibold text-green-700">Defense Application: Focus challenges on whether genuine probable cause existed before the search. If probable cause was absent, the search is unlawful despite the exception.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="strategy" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Strategic Defense in High-Profile Cases</h2>
                    </div>
                    <p class="mb-6 text-red-700 bg-red-100 p-3 rounded-lg border border-red-300">
                        Disclaimer: These are useful steps and potential defenses for your cases, but hard work, meticulous preparation, and extensive research are the only ways to ensure a successful case outcome. Each case is unique and requires a tailored approach.
                    </p>
                    <p class="mb-6 text-gray-600">High-stakes cases require tailored defense strategies that target common prosecution tactics. This section provides key strategic points for specific types of high-profile cases. Click each topic to expand and view critical areas to challenge, from search warrants to forensic evidence, and how to leverage specific legal concepts.</p>
                    <div class="space-y-4">
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left">
                                <span>Drug Trafficking</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <ul class="list-disc list-inside mt-2 space-y-2 text-gray-600">
                                    <li>Challenge the scope of search and seizure warrants. Were they overly broad or unsupported by probable cause?</li>
                                    <li>Leverage the <a href="#laws" class="text-blue-600 hover:underline">Marijuana Decriminalization Act</a>: mere presence or personal use of marijuana is not probable cause for further searching (refer to "Enforcement" details).</li>
                                    <li>Examine warrant justifications for overreach, staleness, or lack of probable cause (refer to <a href="#search" class="text-blue-600 hover:underline">Search & Seizure Protocols</a>).</li>
                                </ul>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left">
                                <span>Possession of Controlled Substances</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <ul class="list-disc list-inside mt-2 space-y-2 text-gray-600">
                                    <li>Challenge lack of knowledge or intent: Was the client aware of the substance's presence or its illegal nature?</li>
                                    <li>Move to suppress evidence based on unlawful search and seizure (refer to <a href="#search" class="text-blue-600 hover:underline">Search & Seizure Protocols</a> and <a href="#caselaw" class="text-blue-600 hover:underline">relevant Case Law</a>).</li>
                                    <li>Challenge the chain of custody for the seized substance: Were proper procedures followed from collection to lab analysis?</li>
                                    <li>Argue for personal use quantity vs. intent to distribute based on amount and packaging.</li>
                                    <li>Explore medical necessity defense if applicable (requires verifiable medical documentation).</li>
                                </ul>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left">
                                <span>Grand Theft Auto</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <ul class="list-disc list-inside mt-2 space-y-2 text-gray-600">
                                    <li>Challenge intent: Was there intent to permanently deprive the owner of the vehicle, or merely joyriding (temporary use)?</li>
                                    <li>Argue mistaken identity: Was the client clearly identified as the person who stole the vehicle?</li>
                                    <li>Assert consent: Did the client have permission from the owner (or someone with apparent authority) to use the vehicle?</li>
                                    <li>Investigate if the vehicle was already stolen or abandoned: Was the client aware of its status?</li>
                                    <li>Move to suppress evidence if the vehicle was recovered via an unlawful search or seizure (refer to <a href="#search" class="text-blue-600 hover:underline">Search & Seizure Protocols</a> and <a href="#caselaw" class="text-blue-600 hover:underline">Carroll v. United States</a>).</li>
                                </ul>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left">
                                <span>Obstruction of a Government Official & Obstruction of Justice</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <ul class="list-disc list-inside mt-2 space-y-2 text-gray-600">
                                    <li>Dispute intent: Did the client specifically intend to obstruct an official act, or were their actions misinterpreted?</li>
                                    <li>Argue that actions were within legal rights: e.g., refusing a search without a warrant, or exercising right to remain silent (refer to <a href="#constitution" class="text-blue-600 hover:underline">Core Constitutional Rights</a> and <a href="#caselaw" class="text-blue-600 hover:underline">Miranda v. Arizona</a>).</li>
                                    <li>Challenge knowledge of official status: Was it clear that the individual being "obstructed" was a government official acting in their capacity?</li>
                                    <li>Investigate the "official act" itself: Was the government official performing a lawful duty at the time of the alleged obstruction?</li>
                                    <li>Seek clarification on the distinction between mere uncooperativeness and active obstruction.</li>
                                </ul>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow-sm">
                            <button class="accordion-toggle w-full flex justify-between items-center p-4 font-bold text-xl text-left">
                                <span>Murder & Attempted Murder</span>
                                <span class="transform transition-transform duration-300">▼</span>
                            </button>
                            <div class="accordion-content">
                                <ul class="list-disc list-inside mt-2 space-y-2 text-gray-600">
                                    <li>Demand full disclosure of all forensic evidence, including collection timelines and lab reports.</li>
                                    <li>Utilize the <a href="#laws" class="text-blue-600 hover:underline">Stand Your Ground Doctrine</a> where applicable to justify your client's actions, ensuring all "reasonable steps" were considered.</li>
                                    <li>Aggressively cross-examine witnesses on inconsistencies and challenge any gaps in the chain of custody for evidence.</li>
                                    <li>Consider <a href="#dueprocess" class="text-blue-600 hover:underline">Double Jeopardy</a> defense if client was previously tried for related lesser charges and new charges arise from the same incident.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="courtroom" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Courtroom Procedures & Etiquette</h2>
                    </div>
                    <p class="mb-6 text-gray-600">This section provides a comprehensive guide to basic courtroom proceedings and essential etiquette for all participants. Adhering to these procedures ensures a fair and orderly trial, upholding the integrity of the judicial process.</p>

                    <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
                        <h3 class="font-bold text-2xl mb-4 text-center">Basic Court Proceedings</h3>
                        <div class="space-y-4">
                            <div class="p-4 bg-blue-100 border-2 border-blue-500 rounded-lg">
                                <h4 class="font-bold text-xl mb-1">Getting Started</h4>
                                <ul class="list-disc list-inside text-gray-700 text-sm space-y-1">
                                    <li>Everyone takes their places within the courtroom.</li>
                                    <li>Upon the entrance of the Judge, everyone will stand until the Bailiff declares that "court is now in session."</li>
                                    <li>Bailiffs will swear in anyone that takes the stand to give testimony.</li>
                                </ul>
                            </div>
                            <div class="flex justify-center text-2xl font-bold text-gray-500">↓ Trial Flow ↓</div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Opening Statements</h4>
                                <p class="text-sm">Begin with opening statements from the Prosecution (generally always goes first) and then the Defense.</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Evidence & Witnesses</h4>
                                <p class="text-sm">Evidence and witnesses can then be called up by either party at the discretion of the Presiding Judge. The opposite side is able to cross-examine evidence given and witnesses called.</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Closing Arguments & Decision</h4>
                                <p class="text-sm">Closing arguments will then take place, followed by a judicial decision from the Presiding Judge.</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
                        <h3 class="font-bold text-2xl mb-4 text-center">Court Etiquette</h3>
                        <div class="space-y-4">
                            <div class="p-4 bg-yellow-100 rounded-lg border-2 border-yellow-500">
                                <h4 class="font-bold text-lg mb-1">Evidence Submission</h4>
                                <p class="text-sm">All of the evidence related to Prosecution will be presented to the Judge prior to the trial, no later than one hour before the trial begins. Any evidence turned in after this time will not be admissible or considered valid.</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Addressing the Judge</h4>
                                <p class="text-sm">The presiding Judge will be addressed simply as "Your Honor."</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Firearms in Courthouse</h4>
                                <p class="text-sm">The only individuals allowed to carry firearms within the courthouse is limited strictly to Bailiffs. Bailiffs will be allowed to carry shotguns if a violent offender is on trial (e.g., coming to court facing a HUT charge).</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Electronic Devices</h4>
                                <p class="text-sm">No cell phones will be permitted inside the courtroom during trials.</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Spectator Limits</h4>
                                <p class="text-sm">The maximum number of spectators will be no more than 15 persons.</p>
                            </div>
                            <div class="p-4 bg-gray-100 rounded-lg border">
                                <h4 class="font-bold text-lg mb-1">Appearance and Conduct</h4>
                                <p class="text-sm">No phones, no masks, no gang identifiers, no weapons. Faces have to be visible at all times.</p>
                                <p class="text-sm mt-1">There is to be no talking during a court proceeding unless you are directly involved in the case and are called upon by the Judge.</p>
                                <p class="text-sm mt-1 text-red-600 font-semibold">Any person talking out of line or disrupting the court proceedings is liable to face a Contempt of Court charge.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tools" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Important Legal Tools and Administrative Processes</h2>
                    </div>
                    <p class="mb-6 text-gray-600">Beyond courtroom strategy, several administrative processes are vital for client advocacy. This section covers expungement, a tool for clearing a client's record, the protocols for accessing sensitive medical records, and the process for Authority Conduct Reviews/Impeachments. The charts visualize fee structures, providing a quick reference for client consultations.</p>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="font-bold text-xl mb-3 text-center">Expungement Fees</h3>
                            <p class="text-gray-600 mb-2 text-sm">Opportunity for rehabilitation, removing criminal conduct from record if crime-free for 20 days (excluding traffic citations).</p>
                            <div class="chart-container h-64 md:h-80">
                                <canvas id="expungementChart"></canvas>
                            </div>
                            <ul class="mt-4 list-disc list-inside text-gray-600 text-sm">
                                <li>Crime-Free Period: 20 days (no arrests/charges for misdemeanors or felonies).</li>
                                <li>Restrictions: Not available for <a href="#dueprocess" class="text-blue-600 hover:underline">Heinous Acts</a>.</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="font-bold text-xl mb-3">Medical Record Access (Patient Information Privacy Protection Act)</h3>
                            <ul class="list-disc list-inside space-y-2 text-gray-600 text-sm">
                                <li>Standard: Requires a signed medical release via contract app from patient or emergency contact. Release must state requester, dates of reports.</li>
                                <li>Unique Situations: If patient/emergency contact cannot/will will not sign, records must be subpoenaed through the Department of Justice.</li>
                                <li>Psych Department: Reports only released to Judge attached to case, docketed only if Judge deems necessary.</li>
                                <li>Autopsy Reports: Exempt from release procedures; deceased do not have rights.</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm col-span-1 lg:col-span-2">
                            <h3 class="font-bold text-xl mb-3 text-center">Authority Conduct Review / Impeachment Process</h3>
                            <p class="text-gray-600 mb-4 text-sm text-center">Allows citizens to file for impeachment or conduct review of any government employee with valid reason and proof of prior rectification attempts. Refer to <a href="#constitution" class="text-blue-600 hover:underline">Constitution Article III</a> (Right to Assemble, Vote, Petition) for justification.</p>
                            <h4 class="font-bold text-lg mb-2">Reasons for Impeachment:</h4>
                            <ul class="list-disc list-inside text-gray-600 grid grid-cols-1 md:grid-cols-2 gap-x-4 text-sm">
                                <li>Dereliction of Duties</li>
                                <li>Gross Negligence</li>
                                <li>Gross Incompetence</li>
                                <li>General Corruption</li>
                                <li>Felony Criminal Conviction</li>
                            </ul>
                            <h4 class="font-bold text-lg mt-4 mb-2 text-center">Process Flow:</h4>
                            <div class="flex flex-col items-center space-y-3 mt-2">
                                <div class="p-3 bg-blue-100 rounded-md border border-blue-300 w-full max-w-md text-sm">1. Filing Request: Submit evidence upon initial filing. Fee paid to DOJ Justice.</div>
                                <span class="text-xl">↓</span>
                                <div class="p-3 bg-blue-100 rounded-md border border-blue-300 w-full max-w-md text-sm">2. Initial Review: DOJ reviews request for completeness. Informs applicant of acceptance/rejection.</div>
                                <span class="text-xl">↓</span>
                                <div class="p-3 bg-blue-100 rounded-md border border-blue-300 w-full max-w-md text-sm">3. Contest Phase: If accepted, review held for 3 days by DOJ.</div>
                                <span class="text-xl">↓</span>
                                <div class="p-3 bg-blue-100 rounded-md border border-blue-300 w-full max-w-md text-sm">4. DOJ Scheduled Public Hearing: If contested, Public Hearing held for arguments and responses.</div>
                                <span class="text-xl">↓</span>
                                <div class="p-3 bg-blue-100 rounded-md border border-blue-300 w-full max-w-md text-sm">5. Deliberation: DOJ & State review arguments/evidence after hearing.</div>
                                <span class="text-xl">↓</span>
                                <div class="p-3 bg-green-100 rounded-md border border-green-300 w-full max-w-md text-sm">6. Decision: Passed, approved, or denied; assigned unique ID and published for public review.</div>
                            </div>
                            <h4 class="font-bold text-lg mt-4 mb-2">Cost to Submit:</h4>
                            <ul class="list-disc list-inside text-gray-600 text-sm">
                                <li>DOJ: $1,000</li>
                                <li>Legislative Authority: $5,000</li>
                                <li>People's Petition: $15,000 OR 20 verifiable signatures</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="leos" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Law Enforcement Officer Powers & Definitions</h2>
                    </div>
                    <p class="mb-6 text-gray-600">Understanding the roles and jurisdictions of various Law Enforcement Agencies (LEOs) is crucial for defense attorneys. This section defines LEOs, outlines their granted powers, and details the geographical and hierarchical jurisdictions of the Los Santos Police Department (LSPD), Blaine County Sheriff's Office (BCSO), and San Andreas State Police (SASP). This knowledge helps in challenging jurisdictional overreach or improper application of force.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-3">Definitions & Granted Powers</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Law Enforcement Officer (LEO): A sworn officer of the BCSO, LSPD, or SASP.</li>
                            <li>Granted Powers: Enforce all state-wide and local laws, issue citations, provide investigative duties within their jurisdictions, and utilize appropriate force to protect citizens, themselves and others.</li>
                        </ul>
                        <h3 class="font-bold text-xl mt-4 mb-3">Jurisdictions</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-2 text-sm">
                            <li>Blaine County Sheriff's Office (BCSO): Ultimate law enforcement authority in Blaine County.</li>
                            <li>Los Santos Police Department (LSPD): Ultimate law enforcement authority in Los Santos.</li>
                            <li>San Andreas State Police (SASP): Ultimate law enforcement authority in the State of San Andreas. SASP has full jurisdiction and ultimate authority over all LEO agencies in conflicts or overlapping jurisdictions.</li>
                            <li>State Jurisdiction: BCSO and LSPD may patrol and enforce State laws in State jurisdiction. Waters and surrounding islands are under shared State Jurisdiction. Air is governed by jurisdiction below up to 10 miles; above is State authority. Undesignated areas are de facto State property with equal LEO powers.</li>
                        </ul>
                        <h4 class="font-bold text-lg mt-4 mb-2">Sub-Authority Rules:</h4>
                        <ul class="list-disc list-inside text-gray-600 space-y-1 text-sm">
                            <li>Los Santos: BCSO may patrol/enforce as sub-authority to LSPD; BCSO must defer to LSPD in conflicts.</li>
                            <li>Blaine County: LSPD may patrol/enforce as sub-authority to BCSO; LSPD must defer to BCSO in conflicts.</li>
                        </ul>
                    </div>
                </div>

                <!-- Important Links Section -->
                <div id="important-links" class="content-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Important Links</h2>
                    </div>
                    <p class="mb-6 text-gray-600">Access key Department of Justice and other essential legal documents and forms here. These links provide direct access to the official resources necessary for various legal processes and filings.</p>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-4">Department of Justice Official Documents</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1utIhLz6oJo4kcLWnK99Dd-TeoFiufWXF_kiySGfcofY/edit" target="_blank" class="font-bold text-blue-700 hover:underline">PLEA AGREEMENT</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1VuLn5pTz9z82MVSeiQctOeldB5UjKzj0RQL7uJiLHBE/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Restraining Order</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1zywuuGMQCTaJ0miYlCiG3cUg-E8OflRQcE5euxTWzI/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Intent to Sue Template (Elevate)</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1xphAbQaUGMk8OCSw-iAKWuwZDp2c6boy_KRc/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Subpoena (Elevate)</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1xGv-jR59oRLcQ3duwBs_fdQ7WcqkZ5Z1F12S0Bc3epY/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Elevate Authority Conduct Complaint Form</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1Km-UXWcqI5Yf5mPmQ6dCvIF-0lvhVgjevCCEdDGCk7k/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Elevate Freedom of Information Act Form</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1hVXpkz8_-_8oOj-B8T6cxw9-7rVL1B2YcRai2YBL8NQ/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Child Adoption Application Form</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1ltKsfyQOi9gHi4m_wNAhA2zpAAy1_GT1unHDm5YdFmQ/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Parole Form</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1Yiemt5PFLRyFr1XK-FzMTq2u9_dnLaxuvmiNDZfhsxg/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Official Complaint</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1DJd3nFfMYV_sfdGgX0jNvumxuPcTxbxkN8jv0nvU/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Court Documentation Guidelines</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1Mp5iBWHWa-QLut1z9dM4DN2P3NHdOui4Grdvfd33CfA/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Los Santos Court Procedure</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1Mp5iBWHWa-QLut1z9dM4DN2P3NHdOui4Grdvfd33CfA/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Los Santos Rules of Evidence</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1MXhsnBOqLl9QobnZQub0ONeDfBR0vEuXpdHSjHY3pzE/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Notice of Arbitration</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1pVB-jGAgf-RMYfdwfFqB8etOWHORNVerHFVjC79IZCI/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Death Certificate</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1Rg8kkzZ_HPxuJSqZOBBLJvjJBqKwwP8EsIgzN-douMA/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Subpoena for Evidence</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1yy7HppySBimyihfFnPn_PGasKl9HnEfctZfCuMheGuU/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Department of Justice Motion for dismissal</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1YdY2619Iki13F81Bko0TCSpyQ9DhdRpBCvYqDKoAQDA/edit?tab=t.0" target="_blank" class="font-bold text-blue-700 hover:underline">Marriage Certificate (Elevate)</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/1pHARuUKPVu5D9cyvmnsH8R6jQyzbGvRgefBImmISIL4/edit?usp=sharing" target="_blank" class="font-bold text-blue-700 hover:underline">Official Business Report</a>
                            </div>
                            <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                                <a href="https://docs.google.com/document/d/12SJb2TSyUmHsSQGp00sxT_O-3r1uQ20HT4DxNpv59kc/edit?tab=t.0" target="_blank" class="font-bold text-blue-700 hover:underline">Lawsuit Demand Letter Example</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- New Job Detail Pages -->
                <div id="job-chief-justice" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Chief Justice Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: Chief Justice of the Supreme Court</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Judiciary Branch</p>
                        <p class="text-gray-700 mb-4"><span class="font-semibold">Reports To:</span> N/A (Highest judicial authority)</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The Chief Justice serves as the head of the Judiciary and presides over the Supreme Court. This role ensures the fair administration of justice, oversees judicial proceedings at the highest level, and manages the conduct, ethics, and standards of all judicial officers under their purview.</p>
                        <h4 class="font-bold text-lg mb-2">Key Responsibilities:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Preside over Supreme Court cases, appeals, and constitutional challenges.</li>
                            <li>Interpret and uphold the Constitution and major legal statutes.</li>
                            <li>Oversee the Judicial Code of Conduct and enforce disciplinary measures when needed.</li>
                            <li>Administer oaths of office to high-ranking officials.</li>
                            <li>Provide judicial leadership and guidance to lower courts and judicial personnel.</li>
                            <li>Serve as the final authority on judicial procedure, precedent, and court policy.</li>
                        </ul>
                    </div>
                </div>

                <div id="job-deputy-chief-justice" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Deputy Chief Justice Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: Deputy Chief Justice</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Judiciary Branch</p>
                        <p class="text-gray-700 mb-4"><span class="font-semibold">Reports To:</span> Chief Justice</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The Deputy Chief Justice assists the Chief Justice in the administration of the judicial system, presides over high-profile or appellate cases, and ensures consistency in court proceedings. This position often oversees the day-to-day functionality of court operations and serves as Acting Chief Justice in their absence.</p>
                        <h4 class="font-bold text-lg mb-2">Key Responsibilities:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Preside over appellate and major trial proceedings.</li>
                            <li>Advise on court procedure, judicial appointments, and legal interpretations.</li>
                            <li>Provide oversight of case management, judge training, and legal compliance.</li>
                            <li>Support the Chief Justice in upholding judicial ethics and institutional integrity.</li>
                            <li>Lead committees on judicial reform or disciplinary review.</li>
                        </ul>
                    </div>
                </div>

                <div id="job-district-attorney" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">District Attorney Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: District Attorney (DA)</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Prosecutor’s Office (Executive Branch – DOJ)</p>
                        <p class="text-gray-700 mb-4"><span class="font-semibold">Reports To:</span> Attorney General or Chief Prosecutor (depending on jurisdiction)</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The District Attorney is the chief prosecutor responsible for pursuing criminal charges on behalf of the state. The DA leads the prosecution team, determines charges in felony and high-priority cases, and ensures that justice is pursued fairly and within the bounds of the law.</p>
                        <h4 class="font-bold text-lg mb-2">Key Responsibilities:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Review evidence from law enforcement and determine prosecutorial action.</li>
                            <li>Lead major criminal prosecutions and oversee courtroom litigation.</li>
                            <li>Supervise Assistant District Attorneys and legal support staff.</li>
                            <li>Collaborate with police departments and investigators on ongoing cases.</li>
                            <li>Uphold ethical prosecution practices and victims’ rights.</li>
                        </ul>
                    </div>
                </div>

                <div id="job-assistant-district-attorney" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Assistant District Attorney Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: Assistant District Attorney (ADA)</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Prosecutor’s Office</p>
                        <p class="text-gray-700 mb-4"><span class="font-semibold">Reports To:</span> District Attorney</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The Assistant District Attorney supports the DA by prosecuting cases ranging from misdemeanors to felonies. ADAs prepare case files, examine evidence, work with law enforcement, and represent the State in criminal proceedings to ensure justice and community safety.</p>
                        <h4 class="font-bold text-lg mb-2">Key Responsibilities:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Prosecute assigned criminal cases in lower and trial courts.</li>
                            <li>Conduct legal research, draft motions, and prepare plea agreements.</li>
                            <li>Interview witnesses, police, and victims in preparation for trial.</li>
                            <li>Present arguments in pre-trial, trial, and sentencing hearings.</li>
                            <li>Maintain case files, coordinate with detectives, and uphold due process.</li>
                        </ul>
                    </div>
                </div>

                <div id="job-defense-attorney" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Defense Attorney Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: Public Defender / Defense Attorney</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Public Defender’s Office (Judicial or Independent Defense Branch)</p>
                        <p class="text-700 mb-4"><span class="font-semibold">Reports To:</span> Chief Public Defender or Self-Employed (if private practice)</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The Defense Attorney represents individuals accused of crimes, ensuring their constitutional rights are preserved. This role requires zealous advocacy, critical analysis of the prosecution's case, and effective courtroom litigation.</p>
                        <h4 class="font-bold text-lg mb-2">Key Responsibilities:</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Represent clients at arraignment, bail, pre-trial, trial, and sentencing.</li>
                            <li>Investigate charges, collect evidence, and interview witnesses.</li>
                            <li>File motions to suppress, dismiss, or otherwise challenge prosecution claims.</li>
                            <li>Negotiate plea deals or pursue trial strategy based on client’s best interests.</li>
                            <li>Safeguard the rights of the accused and uphold the adversarial system.</li>
                        </ul>
                    </div>
                </div>

                <div id="job-chief-prosecutor" class="content-section job-detail-section">
                    <div class="clearfix">
                        <img src="https://www.justice.gov/d9/styles/coh_medium/public/2025-03/doj-seal-257x257.png?itok=gCU0Ex9z" alt="Department of Justice Seal" class="float-right w-24 h-24 ml-4 rounded-full shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/96x96/cccccc/000000?text=Image+Error';">
                        <h2 class="text-3xl font-bold mb-4 text-gray-900">Chief Prosecutor Role Details</h2>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm">
                        <h3 class="font-bold text-xl mb-2">Title: Chief Prosecutor</h3>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Department:</span> Executive Branch – Department of Justice</p>
                        <p class="text-gray-700 mb-2"><span class="font-semibold">Reports To:</span> Attorney General or Secretary of Justice (depending on hierarchy)</p>
                        <p class="gray-700 mb-4"><span class="font-semibold">Supervises:</span> District Attorneys, Special Prosecutors, Investigative Teams, Legal Clerks</p>
                        <h4 class="font-bold text-lg mb-2">Position Summary:</h4>
                        <p class="text-gray-700 leading-relaxed mb-4">The Chief Prosecutor is the highest-ranking official in the prosecutorial division of the Department of Justice. Tasked with overseeing the prosecution of criminal offenses on behalf of the State, the Chief Prosecutor exercises authority over legal strategy, case management, and prosecutorial policy. This position serves as the principal architect of the DOJ’s prosecutorial priorities and ensures the ethical and effective pursuit of justice.</p>
                        
                        <h4 class="font-bold text-lg mb-2">⚖️ Strategic Oversight and Case Management</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Supervise and direct all criminal prosecutions initiated by the State, especially high-profile or complex matters.</li>
                            <li>Evaluate the legal sufficiency and strategic viability of major cases before charges are filed.</li>
                            <li>Review and approve charging decisions, plea agreements, and prosecutorial dismissals in significant cases.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">👨‍⚖️ Leadership and Supervision</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Oversee District Attorneys and Assistant District Attorneys across all regional jurisdictions.</li>
                            <li>Assign or reassign cases to appropriate prosecutors based on complexity, expertise, and ethical considerations.</li>
                            <li>Conduct regular reviews of prosecutorial performance, courtroom conduct, and case outcomes.</li>
                            <li>Provide mentorship and continuing legal education for subordinate attorneys.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">📜 Policy Development and Implementation</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Develop and enforce prosecutorial standards, including ethical guidelines, sentencing recommendations, and procedural protocols.</li>
                            <li>Draft internal policies regarding prosecution of specialized offenses (e.g., organized crime, corruption, white-collar crime).</li>
                            <li>Coordinate closely with legislative bodies to propose statutory reforms when necessary.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">🕵️ Interagency Coordination</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Collaborate with law enforcement agencies, investigative bureaus, and forensic teams to ensure comprehensive case development.</li>
                            <li>Provide legal direction and oversight on active criminal investigations.</li>
                            <li>Coordinate with federal or state agencies in multi-jurisdictional prosecutions.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">🧾 Accountability and Public Trust</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Serve as the public face of the prosecutorial system, issuing statements on prosecutorial decisions when appropriate.</li>
                            <li>Address public concerns regarding prosecutorial conduct, discretion, or outcomes.</li>
                            <li>Ensure that prosecutorial practices uphold due process, equal protection, and nonpartisanship.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">⚖️ Judicial Liaison and Courtroom Presence</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Represent the DOJ before the judiciary in sensitive or precedent-setting trials.</li>
                            <li>Serve as lead prosecutor in exceptional or critical cases requiring senior-level attention.</li>
                            <li>Maintain professional relationships with judges, defense counsel, and judicial administrative staff.</li>
                        </ul>

                        <h4 class="font-bold text-lg mt-4 mb-2">🧑‍💼 Administrative Duties</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li>Manage staffing, budgets, and internal resource allocation for the prosecutorial division.</li>
                            <li>Approve or initiate disciplinary actions for prosecutorial misconduct or dereliction of duty.</li>
                            <li>Prepare annual performance reports and strategic reviews for oversight authorities.</li>
                        </ul>
                    </div>
                </div>

            </div> <!-- End of max-w-screen-xl mx-auto wrapper -->
        </main>
    </div>

    <script>
        // Global variable to store penal codes data
        let penalCodesData = [];
        // Global variable to store currently selected charges for the calculator
        // Now stores fullChargeName (e.g., "S.A.C. § 100 - Assault") for unique identification
        let selectedCharges = []; 
        // Global variable for selected reduction percentage
        let selectedReduction = {
            type: 'standard', // 'standard' or 'custom'
            value: 0 // Numeric percentage or '0' for no reduction
        };

        // Function to parse JSON data
        function parseJSONData(jsonData) {
            const data = [];
            jsonData.forEach(item => {
                // Log the raw item to see its structure
                console.log("Raw JSON item:", item);

                // Mapping JSON keys to the expected structure
                let sentencingMonthsValue;
                // Handle "Prison Time" which can be "Life" or a number
                if (typeof item["Prison Time"] === 'string' && item["Prison Time"].toLowerCase() === 'life') {
                    sentencingMonthsValue = 999999; // Using a large number to represent 'Life'
                } else if (typeof item["Prison Time"] === 'string' && !isNaN(parseInt(item["Prison Time"]))) {
                    // If it's a string that can be parsed as a number
                    sentencingMonthsValue = parseInt(item["Prison Time"]);
                }
                else if (typeof item["Prison Time"] === 'number') {
                    sentencingMonthsValue = item["Prison Time"];
                } else {
                    sentencingMonthsValue = 0; // Default to 0 if not a number or 'life'
                }

                // Handle "Fine" which should be a number (or string that can be parsed)
                let fineValue;
                if (typeof item["Fine"] === 'string' && !isNaN(parseInt(item["Fine"]))) {
                     fineValue = parseInt(item["Fine"]);
                } else if (typeof item["Fine"] === 'number') {
                    fineValue = item["Fine"];
                } else {
                    fineValue = 0; // Default to 0 if not a number
                }


                const rowData = {
                    // Correctly mapping "Code", "Charge", "Description", "Category", "Prison Time", "Fine"
                    section: item.Code || '',
                    charge: item.Charge || '',
                    description: item.Description || '',
                    category: item.Category || '',
                    sentencingMonths: sentencingMonthsValue,
                    fine: fineValue
                };
                data.push(rowData);
                // Log the parsed row data
                console.log("Parsed row data:", rowData);
            });
            return data;
        }

        document.addEventListener('DOMContentLoaded', async function() {
            // Define primary and fallback JSON paths
            const primaryJsonFilePath = 'Criminal Charges JSON Data.txt'; // Changed to .txt as user uploaded it as text/plain
            // Corrected raw GitHub URL for the fallback
            const fallbackJsonUrl = 'https://raw.githubusercontent.com/Tony-Dunkle/DOJ-Training/496b5c5b3b698eda123c33b2328d711ee9285f6e/Criminal%20Charges%20JSON%20Data.txt';

            let fetchedFromPrimary = false;
            try {
                // Try fetching from the primary local path first
                let response = await fetch(primaryJsonFilePath);
                if (response.ok) {
                    const jsonData = await response.json(); // Use .json() as the content is JSON
                    penalCodesData = parseJSONData(jsonData);
                    fetchedFromPrimary = true;
                    console.log("Penal Codes Data loaded from primary source.");
                } else {
                    console.warn(`Primary JSON fetch failed (${response.status}), trying fallback URL...`);
                }
            } catch (error) {
                console.warn("Error fetching primary JSON:", error);
            }

            // If primary fetch failed or resulted in empty data, try the fallback
            if (!fetchedFromPrimary || penalCodesData.length === 0) {
                try {
                    let response = await fetch(fallbackJsonUrl);
                    if (response.ok) {
                        const jsonData = await response.json(); // Use .json() as the content is JSON
                        penalCodesData = parseJSONData(jsonData);
                        if (penalCodesData.length > 0) {
                             console.log("Penal Codes Data loaded from fallback source.");
                        } else {
                             console.error("Fallback JSON loaded, but parsing resulted in empty data.");
                        }
                    } else {
                        throw new Error(`Fallback JSON fetch failed (${response.status}) as well.`);
                    }
                } catch (error) {
                    console.error("Error fetching or parsing JSON from fallback source:", error);
                    // Fallback to a minimal dataset if all fetches fail to prevent breaking the app entirely
                    penalCodesData = [
                        { section: "S.A.C. § 100", charge: "Default Charge", description: "This is a fallback charge.", category: "Misdemeanor", sentencingMonths: 5, fine: 100 },
                        { section: "S.A.C. § 101", charge: "Another Default", description: "Another fallback charge.", category: "Felony", sentencingMonths: 15, fine: 500 }
                    ];
                    // Removed alert for a less intrusive user experience.
                }
            }

            // Log final penalCodesData to inspect its contents after loading
            console.log("Final Penal Codes Data:", penalCodesData);


            const navItems = document.querySelectorAll('.nav-item');
            const contentSections = document.querySelectorAll('.content-section');
            const mobileNavToggle = document.getElementById('mobile-nav-toggle');
            const mobileSidebarContent = document.getElementById('mobile-sidebar-content'); 
            const mobileSidebarOverlay = document.getElementById('mobile-sidebar-overlay');

            // Calculator elements
            const chargeSelectionDisplay = document.getElementById('chargeSelectionDisplay');
            const reductionSelectionDisplay = document.getElementById('reductionSelectionDisplay');
            const applyReductionBtn = document.getElementById('applyReductionBtn');
            const reductionResultsDiv = document.getElementById('reductionResults');
            const totalResultsDiv = document.getElementById('totalResults');
            const finalTotalSentencingSpan = document.getElementById('finalTotalSentencing');
            const finalTotalFineSpan = document.getElementById('finalTotalFine');

            // Charge Selection Modal elements
            const chargeSelectionModal = document.getElementById('chargeSelectionModal');
            const closeChargeModalBtn = document.getElementById('closeChargeModal');
            const chargeSearchInput = document.getElementById('chargeSearchInput');
            const chargesListDiv = document.getElementById('chargesList');
            const clearAllChargesBtn = document.getElementById('clearAllChargesBtn');
            const applySelectedChargesBtn = document.getElementById('applySelectedChargesBtn');

            // Reduction Selection Modal elements
            const reductionSelectionModal = document.getElementById('reductionSelectionModal');
            const closeReductionModalBtn = document.getElementById('closeReductionModal');
            const reductionOptionsList = document.getElementById('reductionOptionsList');
            const customReductionInputModalDiv = document.getElementById('customReductionInputModalDiv');
            const customReductionInputModal = document.getElementById('customReductionInputModal');
            const applySelectedReductionBtn = document.getElementById('applySelectedReductionBtn');

            // Job detail page elements
            const jobTitleLinks = document.querySelectorAll('.job-title-link');
            const jobDetailSections = document.querySelectorAll('.job-detail-section');


            function updateContent(hash) {
                const targetHash = hash || '#introduction'; // Default to introduction
                
                // Hide all content sections (main and job detail)
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                jobDetailSections.forEach(section => {
                    section.classList.remove('active');
                });

                // Show the target section
                const targetSection = document.querySelector(targetHash);
                if (targetSection) {
                    targetSection.classList.add('active');
                }

                // For mobile, close sidebar after clicking a nav item
                if (window.innerWidth < 768 && mobileSidebarContent.classList.contains('active')) { // Use mobileSidebarContent
                    mobileSidebarContent.classList.remove('active');
                    mobileSidebarOverlay.classList.remove('active');
                }

                // Update active state of sidebar navigation items
                navItems.forEach(nav => {
                    if (nav.getAttribute('href') === targetHash) {
                        nav.classList.add('active');
                    } else {
                        nav.classList.remove('active');
                    }
                });

                // Call functions to populate table and create charts when relevant section is active
                // Ensure data is loaded before calling these functions
                if (penalCodesData.length > 0) {
                    if (targetHash === '#sentencing-guidelines') {
                        populateSentencingTable();
                        createMedianSentencingChart();
                        createMedianFinesChart();
                        document.getElementById('totalChargesCount').textContent = penalCodesData.length;
                    } else if (targetHash === '#dueprocess') {
                        createLimitationsChart();
                    } else if (targetHash === '#tools') {
                        createExpungementChart();
                    }
                } else {
                    console.warn("Penal codes data not loaded. Charts and tables might not display correctly.");
                }
            }
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetHash = this.getAttribute('href');
                    history.pushState(null, null, targetHash);
                    updateContent(targetHash);
                });
            });

            window.addEventListener('popstate', function() {
                updateContent(window.location.hash);
            });

            // Mobile nav toggle functionality
            mobileNavToggle.addEventListener('click', function() {
                mobileSidebarContent.classList.toggle('active');
                mobileSidebarOverlay.classList.toggle('active');
            });

            // Close sidebar when clicking outside (on overlay)
            mobileSidebarOverlay.addEventListener('click', function() {
                mobileSidebarContent.classList.remove('active');
                mobileSidebarOverlay.classList.remove('active');
            });

            // Initial content update when the page loads
            updateContent(window.location.hash);

            // Chart.js Implementations
            function createLimitationsChart() {
                const ctx = document.getElementById('limitationsChart')?.getContext('2d');
                if (!ctx) return;
                // Destroy existing chart instance if it exists to prevent re-initialization issues
                if (window.limitationsChartInstance) {
                    window.limitationsChartInstance.destroy();
                }
                window.limitationsChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Criminal Charges Filing', 'Evidence Collection'],
                        datasets: [{
                            label: 'Time Limit (Days)',
                            data: [15, 15], /* Updated to 15 days based on Elevate Legislation */
                            backgroundColor: ['rgba(59, 130, 246, 0.7)', 'rgba(239, 68, 68, 0.7)'],
                            borderColor: ['rgba(59, 130, 246, 1)', 'rgba(239, 68, 68, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Days' } }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            function createExpungementChart() {
                const ctx = document.getElementById('expungementChart')?.getContext('2d');
                if (!ctx) return;
                // Destroy existing chart instance if it exists
                if (window.expungementChartInstance) {
                    window.expungementChartInstance.destroy();
                }
                window.expungementChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Infraction', 'Misdemeanor', 'Felony'], /* Updated labels based on Elevate Legislation */
                        datasets: [{
                            label: 'Fee ($)',
                            data: [1500, 3000, 6000], /* Updated data based on Elevate Legislation */
                            backgroundColor: ['rgba(16, 185, 129, 0.7)', 'rgba(251, 191, 36, 0.7)', 'rgba(220, 38, 38, 0.7)'],
                            borderColor: ['rgba(16, 185, 129, 1)', 'rgba(251, 191, 36, 1)', 'rgba(220, 38, 38, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Fee in USD' } }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            // Function to calculate median
            function calculateMedian(arr) {
                if (arr.length === 0) return 0;
                const sorted = Array.from(arr).sort((a, b) => a - b);
                const middle = Math.floor(sorted.length / 2);
                if (sorted.length % 2 === 0) {
                    return (sorted[middle - 1] + sorted[middle]) / 2;
                }
                return sorted[middle];
            }

            // Group data by category and calculate medians
            let categories = {};
            // Define an explicit order for chart labels
            const desiredCategoryOrder = ['Infraction', 'Misdemeanor', 'Felony', 'Serious Felony', 'Federal', 'Citation']; // Added 'Citation'

            if (penalCodesData.length > 0) {
                 penalCodesData.forEach(item => {
                    const category = item.category.trim(); // Trim whitespace
                    if (!categories[category]) {
                        categories[category] = {
                            sentencingMonths: [],
                            fines: []
                        };
                    }
                    // Exclude the outlier 999999 from median calculation
                    if (item.sentencingMonths !== 999999) {
                        categories[category].sentencingMonths.push(item.sentencingMonths);
                    }
                    categories[category].fines.push(item.fine);
                });
            }
           
            const medianSentencing = {};
            const medianFines = {};
            
            // Populate medians, ensuring only valid categories are processed
            desiredCategoryOrder.forEach(categoryName => {
                if (categories[categoryName]) {
                    medianSentencing[categoryName] = calculateMedian(categories[categoryName].sentencingMonths);
                    medianFines[categoryName] = calculateMedian(categories[categoryName].fines);
                }
            });

            // Use only the categories that actually have data, in the desired order
            const chartLabels = desiredCategoryOrder.filter(label => categories[label]);
            const chartSentencingData = chartLabels.map(label => medianSentencing[label]);
            const chartFinesData = chartLabels.map(label => medianFines[label]);


            function createMedianSentencingChart() {
                const ctx = document.getElementById('medianSentencingChart')?.getContext('2d');
                if (!ctx) return;
                if (window.medianSentencingChartInstance) {
                    window.medianSentencingChartInstance.destroy();
                }
                window.medianSentencingChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            label: 'Median Sentencing (Months)',
                            data: chartSentencingData,
                            backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Months' } }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            function createMedianFinesChart() {
                const ctx = document.getElementById('medianFinesChart')?.getContext('2d');
                if (!ctx) return;
                if (window.medianFinesChartInstance) {
                    window.medianFinesChartInstance.destroy();
                }
                window.medianFinesChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            label: 'Median Fine ($)',
                            data: chartFinesData,
                            backgroundColor: 'rgba(153, 102, 255, 0.7)',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Fine ($)' } }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            // Function to populate the sentencing table
            function populateSentencingTable() {
                const tableBody = document.getElementById('sentencingTableBody');
                if (!tableBody) return;
                tableBody.innerHTML = ''; // Clear existing content

                penalCodesData.forEach(item => {
                    const row = tableBody.insertRow();
                    row.classList.add('border-b');
                    row.innerHTML = `
                        <td class="py-2 px-4 text-sm text-gray-700">${item.section || ''}</td>
                        <td class="py-2 px-4 text-sm text-gray-700">${item.charge || ''}</td>
                        <td class="py-2 px-4 text-sm text-gray-700">${item.description || ''}</td>
                        <td class="py-2 px-4 text-sm text-gray-700">${item.category || ''}</td>
                        <td class="py-2 px-4 text-sm text-gray-700">${item.sentencingMonths === 999999 ? 'Life' : item.sentencingMonths || ''}</td>
                        <td class="py-2 px-4 text-sm text-gray-700">$${item.fine?.toLocaleString() || ''}</td>
                    `;
                });
            }


            // Case Law Tabs
            const caseTabs = document.querySelectorAll('.case-tab');
            const caseContents = document.querySelectorAll('.case-content');
            
            caseTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetCase = this.dataset.case;

                    caseTabs.forEach(t => {
                        t.classList.remove('border-blue-500', 'text-blue-600');
                        t.classList.add('text-gray-500');
                    });
                    this.classList.add('border-blue-500', 'text-blue-600');
                    this.classList.remove('text-gray-500');

                    caseContents.forEach(content => {
                        if (content.id === 'case-' + targetCase) {
                            content.classList.remove('hidden');
                        } else {
                            content.classList.add('hidden');
                        }
                    });
                });
            });

            // Accordion for Strategic Defense and Specific Legislation (Rewritten)
            const accordionToggles = document.querySelectorAll('.accordion-toggle');
            accordionToggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const content = this.nextElementSibling; // This is the .accordion-content div
                    const icon = this.querySelector('span:last-child');
                    
                    content.classList.toggle('expanded'); // Toggle the expanded class
                    if (content.classList.contains('expanded')) {
                        icon.style.transform = 'rotate(180deg)';
                    } else {
                        icon.style.transform = 'rotate(0deg)';
                    }
                });
            });

            // Logic for Charge Reduction Calculator
            applyReductionBtn.addEventListener('click', calculateReduction);

            // Function to calculate reduction
            function calculateReduction() {
                let reductionPercentage = selectedReduction.value;
                if (selectedReduction.type === 'custom') {
                    const customValue = parseFloat(customReductionInputModal.value);
                    if (isNaN(customValue) || customValue < 0 || customValue > 100) {
                        reductionResultsDiv.innerHTML = `
                            <div class="p-3 border border-red-200 rounded-md bg-red-50">
                                <p class="font-semibold text-red-700">Please enter a valid reduction percentage between 0 and 100 for custom reduction.</p>
                            </div>
                        `;
                        totalResultsDiv.classList.add('hidden');
                        return;
                    }
                    reductionPercentage = customValue;
                }

                reductionResultsDiv.innerHTML = ''; // Clear previous results
                totalResultsDiv.classList.add('hidden'); // Hide totals until calculated

                if (selectedCharges.length === 0) {
                    reductionResultsDiv.innerHTML = `
                        <div class="p-3 border border-blue-200 rounded-md bg-blue-50">
                            <p class="text-gray-600">Select charges and a reduction to see results.</p>
                        </div>
                    `;
                    return;
                }

                let resultsHtml = '';
                let overallTotalSentencing = 0;
                let overallTotalFine = 0;
                let hasLifeSentence = false;

                selectedCharges.forEach(selectedFullChargeName => {
                    const matchedCharge = penalCodesData.find(data => {
                        const dataFullChargeName = (data.section && data.section !== '' ? `${data.section} - ` : '') + data.charge;
                        return dataFullChargeName.toLowerCase() === selectedFullChargeName.toLowerCase();
                    });

                    if (matchedCharge) {
                        const originalSentencing = matchedCharge.sentencingMonths;
                        const originalFine = matchedCharge.fine;
                        const sacCode = matchedCharge.section && matchedCharge.section !== '' ? matchedCharge.section : '';

                        let currentReducedSentencingText;
                        let currentReducedFineText;
                        let currentReducedSentencingValue = 0;
                        let currentReducedFineValue = 0;

                        if (originalSentencing === 999999) { // Check for 'Life' sentence
                            currentReducedSentencingText = 'Life';
                            currentReducedFineText = `<span class="font-bold text-green-700">$${(originalFine * (1 - (reductionPercentage / 100))).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>`;
                            currentReducedFineValue = originalFine * (1 - (reductionPercentage / 100));
                            hasLifeSentence = true;
                            currentReducedSentencingValue = 999999;
                        } else {
                            const reducedSentencing = originalSentencing * (1 - (reductionPercentage / 100));
                            const reducedFine = originalFine * (1 - (reductionPercentage / 100));
                            currentReducedSentencingText = `<span class="font-bold text-green-700">${reducedSentencing.toFixed(0)} Months</span>`;
                            currentReducedFineText = `<span class="font-bold text-green-700">$${reducedFine.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>`;
                            currentReducedSentencingValue = reducedSentencing;
                            currentReducedFineValue = reducedFine;
                        }

                        resultsHtml += `
                            <div class="p-3 border border-blue-200 rounded-md bg-blue-50">
                                <p class="font-semibold">${selectedFullChargeName}</p>
                                <p>Original Prison Time: ${originalSentencing === 999999 ? 'Life' : originalSentencing + ' Months'}</p>
                                <p>Reduced Prison Time (${reductionPercentage}% off): ${currentReducedSentencingText}</p>
                                <p>Original Fine: $${originalFine.toLocaleString()}</p>
                                <p>Reduced Fine (${reductionPercentage}% off): ${currentReducedFineText}</p>
                            </div>
                        `;
                        if (currentReducedSentencingValue === 999999) {
                            overallTotalSentencing = 'Life'; // If any charge is life, total is life
                            hasLifeSentence = true;
                        } else if (!hasLifeSentence) { // Only add if no life sentence yet
                            overallTotalSentencing += currentReducedSentencingValue;
                        }
                        overallTotalFine += currentReducedFineValue;

                    } else {
                        resultsHtml += `
                            <div class="p-3 border border-red-200 rounded-md bg-red-50">
                                <p class="font-semibold text-red-700">Error: Charge "${selectedFullChargeName}" not found in data.</p>
                            </div>
                        `;
                    }
                });
                reductionResultsDiv.innerHTML = resultsHtml;

                totalResultsDiv.classList.remove('hidden');
                if (hasLifeSentence) {
                    finalTotalSentencingSpan.textContent = 'Life';
                } else {
                    finalTotalSentencingSpan.textContent = `${overallTotalSentencing.toFixed(0)} Months`;
                }
                finalTotalFineSpan.textContent = `$${overallTotalFine.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            }

            // --- Charge Selection Modal Logic ---
            let chargesInModal = []; // Temporary array to hold selections while modal is open

            chargeSelectionDisplay.addEventListener('click', openChargeSelectionModal);
            closeChargeModalBtn.addEventListener('click', closeChargeSelectionModal);
            chargeSelectionModal.addEventListener('click', (e) => {
                if (e.target === chargeSelectionModal) { // Close when clicking outside content
                    closeChargeSelectionModal();
                }
            });

            chargeSearchInput.addEventListener('keyup', renderChargesListInModal);

            clearAllChargesBtn.addEventListener('click', () => {
                selectedCharges = []; // Clear main selection
                chargesInModal = []; // Clear temporary selection
                updateChargeSelectionDisplay();
                renderChargesListInModal(); // Re-render modal list with all unchecked
                // Also clear calculator results
                reductionResultsDiv.innerHTML = `
                    <div class="p-3 border border-blue-200 rounded-md bg-blue-50">
                        <p class="text-gray-600">Select charges and a reduction to see results.</p>
                    </div>
                `;
                totalResultsDiv.classList.add('hidden');
            });

            applySelectedChargesBtn.addEventListener('click', () => {
                selectedCharges = [...chargesInModal]; // Commit temporary selections to main
                updateChargeSelectionDisplay();
                closeChargeSelectionModal();
            });

            function openChargeSelectionModal() {
                chargesInModal = [...selectedCharges]; // Copy current selections to temporary
                renderChargesListInModal(); // Render charges with current selections
                chargeSelectionModal.style.display = 'flex'; // Show modal
                chargeSearchInput.value = ''; // Clear search input
            }

            function closeChargeSelectionModal() {
                chargeSelectionModal.style.display = 'none'; // Hide modal
            }

            function renderChargesListInModal() {
                chargesListDiv.innerHTML = ''; // Clear previous list
                const searchTerm = chargeSearchInput.value.toLowerCase();

                const filteredCharges = penalCodesData.filter(item => {
                    const fullChargeName = (item.section && item.section !== '' ? `${item.section} - ` : '') + item.charge;
                    return fullChargeName.toLowerCase().includes(searchTerm);
                });

                filteredCharges.forEach(item => {
                    const fullChargeName = (item.section && item.section !== '' ? `${item.section} - ` : '') + item.charge;
                    const listItem = document.createElement('label');
                    listItem.classList.add('charges-list-item');

                    const categoryClass = item.category.toLowerCase().replace(/\s/g, '-');
                    if (categoryClass.includes('felony') || categoryClass.includes('serious-felony') || categoryClass.includes('federal')) {
                        listItem.classList.add('charge-felony');
                    } else if (categoryClass.includes('misdemeanor')) {
                        listItem.classList.add('charge-misdemeanor');
                    } else if (categoryClass.includes('infraction') || categoryClass.includes('citation')) { // Added infraction/citation
                        listItem.classList.add('charge-citation');
                    }

                    // Add 'selected' class if this item is currently selected in the modal
                    if (chargesInModal.includes(fullChargeName)) {
                        listItem.classList.add('selected');
                    }

                    listItem.innerHTML = `
                        <input type="checkbox" value="${fullChargeName}" class="form-checkbox h-5 w-5 text-blue-600 rounded">
                        <span class="text-sm font-medium text-gray-900">${fullChargeName} - Category: ${item.category}</span>
                    `;
                    const checkbox = listItem.querySelector('input[type="checkbox"]');
                    checkbox.checked = chargesInModal.includes(fullChargeName); // Set checked state based on chargesInModal

                    checkbox.addEventListener('change', (e) => {
                        if (e.target.checked) {
                            if (!chargesInModal.includes(fullChargeName)) {
                                chargesInModal.push(fullChargeName);
                                listItem.classList.add('selected'); // Add visual feedback
                            }
                        } else {
                            chargesInModal = chargesInModal.filter(charge => charge !== fullChargeName);
                            listItem.classList.remove('selected'); // Remove visual feedback
                        }
                    });
                    chargesListDiv.appendChild(listItem);
                });
            }

            function updateChargeSelectionDisplay() {
                const displaySpan = chargeSelectionDisplay.querySelector('span');
                if (selectedCharges.length === 0) {
                    displaySpan.textContent = 'No charges selected';
                } else if (selectedCharges.length <= 3) { // Display up to 3 names
                    displaySpan.textContent = selectedCharges.join(', ');
                } else {
                    displaySpan.textContent = `${selectedCharges.length} charges selected`;
                }
            }

            // --- Reduction Selection Modal Logic ---
            let tempReductionSelection = { ...selectedReduction }; // Temporary variable for modal

            reductionSelectionDisplay.addEventListener('click', openReductionSelectionModal);
            closeReductionModalBtn.addEventListener('click', closeReductionSelectionModal);
            reductionSelectionModal.addEventListener('click', (e) => {
                if (e.target === reductionSelectionModal) {
                    closeReductionSelectionModal();
                }
            });

            // Event listener for radio buttons in the modal
            reductionOptionsList.addEventListener('change', (e) => {
                if (e.target.name === 'reductionOption') {
                    tempReductionSelection.type = 'standard';
                    tempReductionSelection.value = parseFloat(e.target.value);
                    if (e.target.value === 'custom') {
                        tempReductionSelection.type = 'custom';
                        customReductionInputModalDiv.classList.remove('hidden');
                        customReductionInputModal.focus();
                    } else {
                        customReductionInputModalDiv.classList.add('hidden');
                    }
                }
            });

            applySelectedReductionBtn.addEventListener('click', () => {
                if (tempReductionSelection.type === 'custom') {
                    const customValue = parseFloat(customReductionInputModal.value);
                    if (isNaN(customValue) || customValue < 0 || customValue > 100) {
                        // Keep modal open and show error (or handle visually in UI)
                        const modalAlert = document.createElement('div');
                        modalAlert.classList.add('p-3', 'bg-red-100', 'text-red-700', 'rounded-md', 'mt-2');
                        modalAlert.textContent = "Please enter a valid custom percentage between 0 and 100.";
                        reductionOptionsList.before(modalAlert); // Add before the list
                        setTimeout(() => modalAlert.remove(), 3000); // Remove after 3 seconds
                        return;
                    }
                    selectedReduction.value = customValue;
                    selectedReduction.type = 'custom';
                } else {
                    selectedReduction.value = tempReductionSelection.value;
                    selectedReduction.type = 'standard';
                }
                updateReductionSelectionDisplay();
                closeReductionSelectionModal();
            });

            function openReductionSelectionModal() {
                tempReductionSelection = { ...selectedReduction }; // Sync temporary with current global selection

                // Set initial state of radio buttons and custom input in the modal
                const radioButtons = reductionOptionsList.querySelectorAll('input[name="reductionOption"]');
                let foundMatch = false;
                radioButtons.forEach(radio => {
                    if (tempReductionSelection.type === 'standard' && parseFloat(radio.value) === tempReductionSelection.value) {
                        radio.checked = true;
                        customReductionInputModalDiv.classList.add('hidden');
                        foundMatch = true;
                    } else if (tempReductionSelection.type === 'custom' && radio.value === 'custom') {
                        radio.checked = true;
                        customReductionInputModalDiv.classList.remove('hidden');
                        customReductionInputModal.value = tempReductionSelection.value;
                        foundMatch = true;
                    } else {
                        radio.checked = false;
                    }
                });

                // If no direct match (e.g., custom value was cleared or invalid), default to "No Reduction"
                if (!foundMatch) {
                    const noReductionRadio = reductionOptionsList.querySelector('input[value="0"]');
                    if (noReductionRadio) noReductionRadio.checked = true;
                    customReductionInputModalDiv.classList.add('hidden');
                    tempReductionSelection = { type: 'standard', value: 0 };
                }

                reductionSelectionModal.style.display = 'flex';
            }

            function closeReductionSelectionModal() {
                reductionSelectionModal.style.display = 'none';
            }

            function updateReductionSelectionDisplay() {
                const displaySpan = reductionSelectionDisplay.querySelector('span');
                if (selectedReduction.type === 'custom') {
                    displaySpan.textContent = `Custom: ${selectedReduction.value}%`;
                } else {
                    displaySpan.textContent = `${selectedReduction.value}% Reduction`;
                    if (selectedReduction.value === 0) {
                        displaySpan.textContent = 'No Reduction (0%)';
                    }
                }
            }

            // Initial display updates on load
            updateChargeSelectionDisplay();
            updateReductionSelectionDisplay();

            // Job Title Click Handling
            jobTitleLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.dataset.target; // Get the ID of the job detail section
                    showJobDetailPage(targetId);
                });
            });

            // Function to show job detail page
            function showJobDetailPage(targetId) {
                // Hide all main content sections
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                // Hide all job detail sections
                jobDetailSections.forEach(section => {
                    section.classList.remove('active');
                });

                // Remove active state from all sidebar nav items
                navItems.forEach(nav => {
                    nav.classList.remove('active');
                });

                // Show the specific job detail section
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    // Scroll to top of main content area (optional, for better UX)
                    document.querySelector('main').scrollTo(0, 0);
                }
            }


            // Use MutationObserver to initialize charts and tables only when their section becomes visible
            const generalObserver = new MutationObserver((mutations) => {
                for (let mutation of mutations) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const targetElement = mutation.target;
                        // Check if it's a main content section and became active
                        if (targetElement.classList.contains('content-section') && !targetElement.classList.contains('job-detail-section') && targetElement.classList.contains('active')) {
                           if (targetElement.id === 'dueprocess') {
                                createLimitationsChart();
                           } else if (targetElement.id === 'tools') {
                                createExpungementChart();
                           } else if (targetElement.id === 'sentencing-guidelines') {
                                populateSentencingTable();
                                createMedianSentencingChart();
                                createMedianFinesChart();
                                document.getElementById('totalChargesCount').textContent = penalCodesData.length;
                           }
                        }
                    }
                }
            });

            // Observe only the main content sections for activation
            contentSections.forEach(section => {
                generalObserver.observe(section, { attributes: true });
            });

            // Initial calls for currently active section on page load
            const currentHash = window.location.hash || '#introduction';
            if (currentHash === '#sentencing-guidelines') {
                // Check if penalCodesData is populated before calling
                if (penalCodesData.length > 0) {
                    populateSentencingTable();
                    createMedianSentencingChart();
                    createMedianFinesChart();
                    document.getElementById('totalChargesCount').textContent = penalCodesData.length;
                } else {
                    // If data not loaded yet, set up an observer to run these functions once data is available
                    // This scenario is now less likely due to improved loading and fallback, but good to keep in mind.
                    // For now, updateContent is called once data is fetched.
                }
            } else if (currentHash === '#dueprocess') {
                createLimitationsChart();
            } else if (currentHash === '#tools') {
                createExpungementChart();
            }
        });
    </script>
</body>
</html>
